{"ast":null,"code":"import React,{useState,useEffect}from'react';import{db}from'../config/firebase';import{collection,getDocs,Timestamp,deleteDoc,doc,updateDoc}from'firebase/firestore';import DatePicker from'react-datepicker';import{registerLocale}from'react-datepicker';import{fr}from'date-fns/locale/fr';import\"react-datepicker/dist/react-datepicker.css\";import'./Passages.css';import'./EditMode.css';import{usePoles}from'../services/PoleService';import PoleSelector from'./PoleSelector';import PoleFilter from'./PoleFilter';// Enregistrer la locale française\nimport{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";registerLocale('fr',fr);// Styles personnalisés pour le datepicker\nconst datepickerStyles=`\n  .react-datepicker {\n    font-family: 'Roboto', sans-serif;\n    border-radius: 8px;\n    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);\n    border: 1px solid #e0e0e0;\n    z-index: 1000;\n  }\n  \n  .react-datepicker-popper {\n    z-index: 1000;\n  }\n  \n  .react-datepicker__header {\n    background-color: #1976d2;\n    border-bottom: none;\n    border-top-left-radius: 8px;\n    border-top-right-radius: 8px;\n    padding-top: 10px;\n  }\n  \n  .react-datepicker__current-month {\n    color: white;\n    font-weight: 500;\n    font-size: 1rem;\n    padding-bottom: 5px;\n  }\n  \n  .react-datepicker__day-name {\n    color: white;\n    font-weight: 500;\n  }\n  \n  .react-datepicker__day--selected {\n    background-color: #1976d2;\n    border-radius: 50%;\n  }\n  \n  .react-datepicker__day:hover {\n    background-color: #e8f0fe;\n    border-radius: 50%;\n  }\n  \n  .react-datepicker__day--keyboard-selected {\n    background-color: #e8f0fe;\n    color: #1976d2;\n    border-radius: 50%;\n  }\n  \n  .react-datepicker__navigation {\n    top: 12px;\n  }\n  \n  .react-datepicker__navigation-icon::before {\n    border-color: white;\n  }\n  \n  .react-datepicker__day--today {\n    font-weight: bold;\n    color: #1976d2;\n  }\n  \n  .custom-datepicker-input {\n    width: 160px;\n    padding: 10px 12px;\n    border-radius: 4px;\n    border: 1px solid #ccc;\n    font-size: 14px;\n    cursor: pointer;\n    background-color: white;\n    transition: all 0.2s ease;\n    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);\n  }\n  \n  .custom-datepicker-input:focus {\n    outline: none;\n    border-color: #1976d2;\n    box-shadow: 0 0 0 2px rgba(25, 118, 210, 0.2);\n  }\n  \n  .custom-datepicker-input::placeholder {\n    color: #aaa;\n  }\n  \n  .custom-datepicker-wrapper {\n    position: relative;\n  }\n  \n  .custom-datepicker-icon {\n    position: absolute;\n    right: 10px;\n    top: 50%;\n    transform: translateY(-50%);\n    color: #666;\n    pointer-events: none;\n  }\n`;const Passages=()=>{const[passages,setPassages]=useState([]);const[allPassages,setAllPassages]=useState([]);const[loading,setLoading]=useState(true);const[error,setError]=useState(null);const[tournees,setTournees]=useState([]);const[sites,setSites]=useState([]);const[vehicules,setVehicules]=useState([]);// Filtres\nconst[dateDebut,setDateDebut]=useState(null);const[dateFin,setDateFin]=useState(null);const[tournee,setTournee]=useState('');const[statut,setStatut]=useState('');const[site,setSite]=useState('');const[vehicule,setVehicule]=useState('');const[idColis,setIdColis]=useState('');// Recherche rapide\nconst[quickSearch,setQuickSearch]=useState('');const[filteredPassages,setFilteredPassages]=useState([]);// Ajout du filtre par pôle\nconst[selectedPole,setSelectedPole]=useState('');// Ajout des états pour le mode édition et la sélection multiple\nconst[editMode,setEditMode]=useState(false);const[selectedPassages,setSelectedPassages]=useState([]);const[editingPassages,setEditingPassages]=useState({});// Utilisation du hook usePoles\nconst{poles}=usePoles();useEffect(()=>{fetchPassages();fetchTournees();fetchSites();fetchVehicules();// Ajouter l'attribut lang=\"fr\" au document pour les calendriers en français\ndocument.documentElement.lang='fr';// Ajouter les styles personnalisés pour le datepicker\nconst styleElement=document.createElement('style');styleElement.textContent=datepickerStyles;document.head.appendChild(styleElement);return()=>{// Nettoyage\ndocument.documentElement.lang='';document.head.removeChild(styleElement);};},[]);// Initialiser les passages filtrés au chargement\nuseEffect(()=>{setFilteredPassages(passages);},[passages]);// Effet pour filtrer les passages en fonction de la recherche rapide et du pôle sélectionné\nuseEffect(()=>{let results=passages;// Filtrer par pôle si un pôle est sélectionné\nif(selectedPole){results=results.filter(passage=>passage.pole===selectedPole);}// Ensuite filtrer par recherche rapide\nif(quickSearch.trim()){const searchTerm=quickSearch.toLowerCase().trim();results=results.filter(passage=>{// Rechercher dans tous les champs textuels du passage\nreturn getSiteName(passage.siteDepart).toLowerCase().includes(searchTerm)||getSiteName(passage.siteFin||'').toLowerCase().includes(searchTerm)||passage.idColis.toLowerCase().includes(searchTerm)||passage.statut.toLowerCase().includes(searchTerm)||(passage.coursierChargement||'').toLowerCase().includes(searchTerm)||(passage.coursierLivraison||'').toLowerCase().includes(searchTerm)||getTourneeName(passage.tourneeId).toLowerCase().includes(searchTerm)||getVehiculeImmatriculation(passage.vehiculeId).toLowerCase().includes(searchTerm)||formatDateFr(convertTimestampToDate(passage.dateHeureDepart)).includes(searchTerm);});}setFilteredPassages(results);},[quickSearch,passages,selectedPole]);// Fonction pour convertir un Timestamp Firebase en Date JavaScript\nconst convertTimestampToDate=timestamp=>{if(!timestamp)return null;// Si c'est déjà un objet Date\nif(timestamp instanceof Date)return timestamp;// Si c'est un Timestamp Firebase avec la méthode toDate()\nif(timestamp&&typeof timestamp.toDate==='function'){return timestamp.toDate();}// Si c'est un objet avec seconds et nanoseconds (format Firestore)\nif(timestamp&&'seconds'in timestamp&&'nanoseconds'in timestamp){return new Date(timestamp.seconds*1000+timestamp.nanoseconds/1000000);}// Si c'est un nombre (timestamp en millisecondes)\nif(typeof timestamp==='number'){return new Date(timestamp);}// Si c'est une chaîne de caractères\nif(typeof timestamp==='string'){return new Date(timestamp);}console.error('Format de timestamp non reconnu:',timestamp);return null;};// Fonction pour comparer uniquement les dates (sans l'heure)\nconst compareDatesOnly=(date1,date2)=>{if(!date1||!date2)return false;// Créer de nouvelles dates avec uniquement l'année, le mois et le jour\nconst onlyDate1=new Date(date1.getFullYear(),date1.getMonth(),date1.getDate());const onlyDate2=new Date(date2.getFullYear(),date2.getMonth(),date2.getDate());// Comparer les timestamps (en millisecondes)\nreturn onlyDate1.getTime()===onlyDate2.getTime();};// Fonction pour vérifier si une date est supérieure ou égale à une autre (sans l'heure)\nconst isDateGreaterOrEqual=(date1,date2)=>{if(!date1||!date2)return false;// Créer de nouvelles dates avec uniquement l'année, le mois et le jour\nconst onlyDate1=new Date(date1.getFullYear(),date1.getMonth(),date1.getDate());const onlyDate2=new Date(date2.getFullYear(),date2.getMonth(),date2.getDate());// Comparer les timestamps (en millisecondes)\nreturn onlyDate1.getTime()>=onlyDate2.getTime();};// Fonction pour vérifier si une date est inférieure ou égale à une autre (sans l'heure)\nconst isDateLessOrEqual=(date1,date2)=>{if(!date1||!date2)return false;// Créer de nouvelles dates avec uniquement l'année, le mois et le jour\nconst onlyDate1=new Date(date1.getFullYear(),date1.getMonth(),date1.getDate());const onlyDate2=new Date(date2.getFullYear(),date2.getMonth(),date2.getDate());// Comparer les timestamps (en millisecondes)\nreturn onlyDate1.getTime()<=onlyDate2.getTime();};const fetchPassages=async()=>{try{setLoading(true);setError(null);// Récupérer les données depuis Firebase\nconst passagesRef=collection(db,'passages');const passagesSnapshot=await getDocs(passagesRef);if(passagesSnapshot.empty){console.log('Aucun passage trouvé dans Firebase');setError('Aucun passage trouvé. Veuillez initialiser les données.');setLoading(false);return;}console.log('Nombre de documents récupérés:',passagesSnapshot.docs.length);// Afficher les données brutes pour comprendre la structure\nconsole.log('Données brutes de Firebase:');passagesSnapshot.docs.forEach((doc,index)=>{console.log(`Document ${index+1} (ID: ${doc.id}):`,doc.data());});const passagesData=passagesSnapshot.docs.map(doc=>{const data=doc.data();// Vérifier les propriétés exactes des données\nconsole.log('Propriétés du document:',Object.keys(data));// Normaliser les noms de propriétés\nconst normalizedData={id:doc.id,siteDepart:data.siteDépart||data.siteDepart||'',dateHeureDepart:data.dhDépart||data.dateHeureDepart,idColis:data.idColis||'',statut:data.statut||'En cours',siteFin:data.siteFin||'',dateHeureFin:data.dhLivraison||data.dateHeureFin,coursierChargement:data.coursierCharg||data.coursierChargement||'',coursierLivraison:data.coursierLivraison||'',vehiculeId:data.véhicule||data.vehiculeId||'',tourneeId:data.tournée||data.tourneeId||'',pole:data.pole||''};return normalizedData;});console.log('Données récupérées de Firebase (après normalisation):',passagesData);setAllPassages(passagesData);setPassages(passagesData);setLoading(false);}catch(error){console.error('Erreur lors de la récupération des passages:',error);setError('Erreur lors de la récupération des données');setLoading(false);}};// Fonction pour récupérer les tournées depuis Firebase\nconst fetchTournees=async()=>{try{const tourneesRef=collection(db,'tournees');const snapshot=await getDocs(tourneesRef);if(!snapshot.empty){const tourneesData=snapshot.docs.map(doc=>{const data=doc.data();return{id:doc.id,nom:data.nom||'',date:data.date||Timestamp.fromDate(new Date()),heureDepart:data.heureDepart||'',heureFinPrevue:data.heureFinPrevue||'',heureFinReelle:data.heureFinReelle||'',coursier:data.coursier||'',vehicule:data.vehicule||'',nombreColis:data.nombreColis||0,statut:data.statut||'en_attente',siteDepart:data.siteDepart||''};});setTournees(tourneesData);}else{console.log(\"Aucune tournée trouvée dans Firebase\");// Définir quelques tournées par défaut si aucune n'est trouvée\nconst defaultTournees=[{id:'1',nom:'Matin',date:Timestamp.fromDate(new Date()),heureDepart:'07:00',heureFinPrevue:'12:00',coursier:'Sébastien Lherlier',vehicule:'GE-695-RT',nombreColis:15,statut:'en_attente',siteDepart:'Laboratoire Central'},{id:'2',nom:'Jour',date:Timestamp.fromDate(new Date()),heureDepart:'12:00',heureFinPrevue:'17:00',coursier:'Guillaume Sage',vehicule:'GI-456-AD',nombreColis:12,statut:'en_attente',siteDepart:'Laboratoire Purpan'},{id:'3',nom:'Soir',date:Timestamp.fromDate(new Date()),heureDepart:'17:00',heureFinPrevue:'22:00',coursier:'Sébastien Lherlier',vehicule:'GE-695-RT',nombreColis:10,statut:'en_attente',siteDepart:'Laboratoire Central'}];setTournees(defaultTournees);}}catch(error){console.error('Erreur lors de la récupération des tournées:',error);}};// Fonction pour récupérer les sites depuis Firebase\nconst fetchSites=async()=>{try{const sitesRef=collection(db,'sites');const snapshot=await getDocs(sitesRef);if(!snapshot.empty){const sitesData=snapshot.docs.map(doc=>{const data=doc.data();return{id:doc.id,nom:data.nom||'',adresse:data.adresse||'',ville:data.ville||'',codePostal:data.codePostal||'',telephone:data.telephone||'',email:data.email||'',type:data.type||'',statut:data.statut||'actif'};});setSites(sitesData);}else{console.log(\"Aucun site trouvé dans Firebase\");// Définir quelques sites par défaut si aucun n'est trouvé\nconst defaultSites=[{id:'1',nom:'Laboratoire Central',adresse:'15 rue des Sciences',ville:'Toulouse',codePostal:'31000',telephone:'05.61.XX.XX.XX',email:'contact@labo-central.fr',type:'Laboratoire',statut:'actif'},{id:'2',nom:'Laboratoire Purpan',adresse:'330 avenue de Grande Bretagne',ville:'Toulouse',codePostal:'31300',telephone:'05.61.XX.XX.XX',email:'contact@labo-purpan.fr',type:'Laboratoire',statut:'actif'}];setSites(defaultSites);}}catch(error){console.error('Erreur lors de la récupération des sites:',error);}};// Fonction pour récupérer les véhicules depuis Firebase\nconst fetchVehicules=async()=>{try{const vehiculesRef=collection(db,'vehicules');const snapshot=await getDocs(vehiculesRef);if(!snapshot.empty){const vehiculesData=snapshot.docs.map(doc=>{const data=doc.data();return{id:doc.id,immatriculation:data.immatriculation||'',marque:data.marque||'',modele:data.modele||'',type:data.type||'',annee:data.annee||2023,statut:data.statut||'actif',dernierEntretien:data.dernierEntretien||'',coursierAssigne:data.coursierAssigne||'',kilometrage:data.kilometrage||0};});setVehicules(vehiculesData);}else{console.log(\"Aucun véhicule trouvé dans Firebase\");// Définir quelques véhicules par défaut si aucun n'est trouvé\nconst defaultVehicules=[{id:'1',immatriculation:'GE-695-RT',marque:'Renault',modele:'Kangoo',type:'Utilitaire',annee:2020,statut:'actif',dernierEntretien:'2023-01-15',coursierAssigne:'Sébastien Lherlier',kilometrage:45000},{id:'2',immatriculation:'GI-456-AD',marque:'Citroën',modele:'Berlingo',type:'Utilitaire',annee:2021,statut:'actif',dernierEntretien:'2023-02-10',coursierAssigne:'Guillaume Sage',kilometrage:32500}];setVehicules(defaultVehicules);}}catch(error){console.error('Erreur lors de la récupération des véhicules:',error);}};// Fonction pour obtenir le nom de la tournée à partir de son ID\nconst getTourneeName=tourneeId=>{if(!tourneeId)return'';const foundTournee=tournees.find(t=>t.id===tourneeId);return foundTournee?foundTournee.nom:tourneeId;};// Fonction pour obtenir le nom du site à partir de son ID\nconst getSiteName=siteId=>{if(!siteId)return'';const foundSite=sites.find(s=>s.id===siteId);return foundSite?foundSite.nom:siteId;};// Fonction pour obtenir l'immatriculation du véhicule à partir de son ID\nconst getVehiculeImmatriculation=vehiculeId=>{if(!vehiculeId)return'';const foundVehicule=vehicules.find(v=>v.id===vehiculeId);return foundVehicule?foundVehicule.immatriculation:vehiculeId;};// Fonction pour formater une date au format français (JJ/MM/AAAA)\nconst formatDateFr=date=>{if(!date)return'';const day=date.getDate().toString().padStart(2,'0');const month=(date.getMonth()+1).toString().padStart(2,'0');const year=date.getFullYear();return`${day}/${month}/${year}`;};// Fonction pour obtenir le nom du pôle\nconst getPoleNameById=poleId=>{if(!poleId)return'-';const pole=poles.find(p=>p.id===poleId);return pole?pole.nom:poleId;};// Fonction pour gérer le changement de pôle\nconst handlePoleChange=pole=>{setSelectedPole(pole);};const handleSearch=()=>{console.log('Recherche démarrée avec les critères suivants:');console.log('Date début:',dateDebut);console.log('Date fin:',dateFin);console.log('Tournée:',tournee);console.log('Statut:',statut);console.log('Site:',site);console.log('Véhicule:',vehicule);console.log('ID Colis:',idColis);console.log('Nombre total de passages avant filtrage:',allPassages.length);try{// Filtrer les passages en fonction des critères sélectionnés\nlet filteredResults=[...allPassages];// Filtrer par date de début\nif(dateDebut){filteredResults=filteredResults.filter(passage=>{const passageDate=convertTimestampToDate(passage.dateHeureDepart);return passageDate&&isDateGreaterOrEqual(passageDate,dateDebut);});}// Filtrer par date de fin\nif(dateFin){filteredResults=filteredResults.filter(passage=>{const passageDate=convertTimestampToDate(passage.dateHeureDepart);return passageDate&&isDateLessOrEqual(passageDate,dateFin);});}// Filtrer par tournée\nif(tournee){filteredResults=filteredResults.filter(passage=>passage.tourneeId===tournee);}// Filtrer par statut\nif(statut){filteredResults=filteredResults.filter(passage=>passage.statut===statut);}// Filtrer par site\nif(site){filteredResults=filteredResults.filter(passage=>passage.siteDepart===site||passage.siteFin===site);}// Filtrer par véhicule\nif(vehicule){filteredResults=filteredResults.filter(passage=>passage.vehiculeId===vehicule);}// Filtrer par ID de colis\nif(idColis){filteredResults=filteredResults.filter(passage=>passage.idColis&&passage.idColis.toLowerCase().includes(idColis.toLowerCase()));}console.log('Nombre de passages après filtrage:',filteredResults.length);// Mettre à jour l'état des passages avec les résultats filtrés\nsetPassages(filteredResults);}catch(error){console.error('Erreur lors de la recherche:',error);setError('Erreur lors de la recherche. Veuillez réessayer.');}};const resetFilters=()=>{setDateDebut(null);setDateFin(null);setTournee('');setStatut('');setSite('');setVehicule('');setIdColis('');setQuickSearch('');setSelectedPole('');setFilteredPassages(passages);};// Ajout de la fonction pour supprimer les passages sélectionnés\nconst handleDeleteSelected=async()=>{if(selectedPassages.length===0){alert('Veuillez sélectionner au moins un passage à supprimer');return;}if(window.confirm(`Êtes-vous sûr de vouloir supprimer ${selectedPassages.length} passage(s) ?`)){try{// Supprimer les passages sélectionnés de Firestore\nconst deletePromises=selectedPassages.map(id=>deleteDoc(doc(db,'passages',id)));await Promise.all(deletePromises);// Mettre à jour l'état local\nsetPassages(passages.filter(passage=>!selectedPassages.includes(passage.id)));setSelectedPassages([]);}catch(error){console.error('Erreur lors de la suppression:',error);setError('Erreur lors de la suppression');}}};// Fonction pour basculer le mode édition\nconst toggleEditMode=()=>{if(!editMode){// Si on entre en mode édition, initialiser l'état d'édition avec les passages actuels\nconsole.log(\"Entrée en mode édition\");const initialEditState={};passages.forEach(passage=>{initialEditState[passage.id]={...passage};});setEditingPassages(initialEditState);// Activer le mode édition\nsetEditMode(true);}else{// Si on quitte le mode édition, demander confirmation\nif(window.confirm(\"Voulez-vous enregistrer les modifications ?\")){console.log(\"Sauvegarde des modifications avant de quitter le mode édition\");// Sauvegarder les modifications et quitter le mode édition après la sauvegarde\nsaveAllChanges().then(()=>{// Désélectionner tout et quitter le mode édition\nsetSelectedPassages([]);setEditMode(false);}).catch(error=>{console.error(\"Erreur lors de la sauvegarde:\",error);// Laisser l'utilisateur en mode édition en cas d'erreur\nalert(\"Une erreur est survenue lors de la sauvegarde. Veuillez réessayer.\");});}else{console.log(\"Annulation des modifications et sortie du mode édition\");// Annuler les modifications et quitter le mode édition\nsetEditingPassages({});setSelectedPassages([]);setEditMode(false);}}};// Fonction pour sauvegarder toutes les modifications\nconst saveAllChanges=async()=>{try{console.log(\"Début de la sauvegarde des modifications...\");console.log(\"Passages à mettre à jour:\",Object.keys(editingPassages).length);// Parcourir tous les passages modifiés et les mettre à jour dans Firestore\nconst updatePromises=Object.entries(editingPassages).map(async _ref=>{let[id,passage]=_ref;try{console.log(`Mise à jour du passage ${id}:`,passage);// Créer un objet avec uniquement les champs définis\nconst updateData={};// Vérifier et ajouter chaque champ s'il est défini\nif(passage.siteDepart!==undefined)updateData.siteDepart=passage.siteDepart;if(passage.dateHeureDepart!==undefined)updateData.dateHeureDepart=passage.dateHeureDepart;if(passage.idColis!==undefined)updateData.idColis=passage.idColis;if(passage.statut!==undefined)updateData.statut=passage.statut;if(passage.siteFin!==undefined)updateData.siteFin=passage.siteFin;if(passage.dateHeureFin!==undefined)updateData.dateHeureFin=passage.dateHeureFin;if(passage.coursierChargement!==undefined)updateData.coursierChargement=passage.coursierChargement;if(passage.coursierLivraison!==undefined)updateData.coursierLivraison=passage.coursierLivraison;if(passage.vehiculeId!==undefined)updateData.vehiculeId=passage.vehiculeId;if(passage.tourneeId!==undefined)updateData.tourneeId=passage.tourneeId;if(passage.pole!==undefined)updateData.pole=passage.pole;await updateDoc(doc(db,'passages',id),updateData);console.log(`Passage ${id} mis à jour avec succès`);return id;}catch(error){console.error(`Erreur lors de la mise à jour du passage ${id}:`,error);throw error;}});// Attendre que toutes les opérations soient terminées\nconst results=await Promise.allSettled(updatePromises);// Vérifier les résultats\nconst fulfilled=results.filter(result=>result.status==='fulfilled').length;const rejected=results.filter(result=>result.status==='rejected').length;console.log(`Opérations terminées: ${fulfilled} réussies, ${rejected} échouées`);if(rejected>0){console.warn(\"Certaines opérations ont échoué. Voir les erreurs ci-dessus.\");}// Mettre à jour l'état local avec les passages modifiés\nsetPassages(passages.map(passage=>{if(editingPassages[passage.id]){return editingPassages[passage.id];}return passage;}));// Rafraîchir les données\nawait fetchPassages();// Réinitialiser les états\nsetEditingPassages({});if(rejected>0){alert(`Modifications partiellement enregistrées. ${rejected} opérations ont échoué.`);}else{alert('Modifications enregistrées avec succès');}console.log('Toutes les modifications ont été enregistrées avec succès');return true;}catch(error){console.error('Erreur lors de la sauvegarde des modifications:',error);alert('Erreur lors de la sauvegarde des modifications. Veuillez réessayer.');throw error;}};// Fonction pour gérer les changements de valeur dans les champs d'édition\nconst handleCellChange=(id,field,value)=>{setEditingPassages({...editingPassages,[id]:{...editingPassages[id],[field]:value}});};// Fonction pour formater une date pour l'input de type date\nconst formatDateForInput=date=>{if(!date)return'';const year=date.getFullYear();const month=(date.getMonth()+1).toString().padStart(2,'0');const day=date.getDate().toString().padStart(2,'0');return`${year}-${month}-${day}`;};// Fonction pour convertir un Timestamp en format d'heure pour input time\nconst convertTimestampToTime=timestamp=>{const date=convertTimestampToDate(timestamp);if(!date)return'';const hours=date.getHours().toString().padStart(2,'0');const minutes=date.getMinutes().toString().padStart(2,'0');return`${hours}:${minutes}`;};// Fonction pour sélectionner/désélectionner un passage\nconst togglePassageSelection=id=>{if(selectedPassages.includes(id)){setSelectedPassages(selectedPassages.filter(passageId=>passageId!==id));}else{setSelectedPassages([...selectedPassages,id]);}};if(loading){return/*#__PURE__*/_jsxs(\"div\",{className:\"loading-container\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"loading-spinner\"}),/*#__PURE__*/_jsx(\"p\",{children:\"Chargement des passages...\"})]});}if(error){return/*#__PURE__*/_jsxs(\"div\",{className:\"error-container\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"error-message\",children:error}),/*#__PURE__*/_jsx(\"button\",{className:\"button\",onClick:fetchPassages,children:\"R\\xE9essayer\"})]});}return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{className:\"section-header\",children:/*#__PURE__*/_jsx(\"h2\",{className:\"section-title\",children:\"Passages\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"sticky-header-container\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"header-actions\",children:editMode?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"button\",{className:\"button button-success\",onClick:toggleEditMode,children:[/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-save\"}),\" Enregistrer\"]}),/*#__PURE__*/_jsxs(\"button\",{className:\"button button-secondary\",onClick:()=>{if(window.confirm(\"Êtes-vous sûr de vouloir annuler toutes les modifications ?\")){setEditingPassages({});setSelectedPassages([]);setEditMode(false);}},style:{marginLeft:'10px'},children:[/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-times\"}),\" Annuler\"]})]}):/*#__PURE__*/_jsxs(\"button\",{className:\"button\",onClick:toggleEditMode,children:[/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-edit\"}),\" Modifier\"]})}),editMode&&/*#__PURE__*/_jsx(\"div\",{className:\"edit-actions\",children:/*#__PURE__*/_jsxs(\"button\",{className:\"button button-danger\",onClick:handleDeleteSelected,disabled:selectedPassages.length===0,children:[/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-trash-alt\"}),\" Supprimer (\",selectedPassages.length,\")\"]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"quick-search-container\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",className:\"quick-search-input\",placeholder:\"Recherche rapide...\",value:quickSearch,onChange:e=>setQuickSearch(e.target.value),title:\"Rechercher dans le tableau\"}),/*#__PURE__*/_jsx(\"div\",{className:\"pole-filter\",children:/*#__PURE__*/_jsx(PoleFilter,{onPoleChange:handlePoleChange,selectedPole:selectedPole,label:\"Filtrer par p\\xF4le\",className:\"pole-filter-component\"})})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"search-filters-container\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"search-filters\",style:{display:'flex',flexWrap:'wrap',gap:'15px'},children:[/*#__PURE__*/_jsxs(\"div\",{className:\"search-group\",style:{display:'flex',flexDirection:'column',gap:'5px'},children:[/*#__PURE__*/_jsx(\"label\",{children:\"Date d\\xE9but:\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"custom-datepicker-wrapper\",children:[/*#__PURE__*/_jsx(DatePicker,{selected:dateDebut,onChange:date=>setDateDebut(date),locale:\"fr\",dateFormat:\"dd/MM/yyyy\",placeholderText:\"JJ/MM/AAAA\",className:\"custom-datepicker-input\",popperPlacement:\"bottom-start\",popperModifiers:[{name:'offset',options:{offset:[0,8]},fn:state=>state}],showMonthDropdown:true,showYearDropdown:true,dropdownMode:\"select\",isClearable:true}),/*#__PURE__*/_jsx(\"span\",{className:\"custom-datepicker-icon\",children:\"\\uD83D\\uDCC5\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"search-group\",style:{display:'flex',flexDirection:'column',gap:'5px'},children:[/*#__PURE__*/_jsx(\"label\",{children:\"Date fin:\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"custom-datepicker-wrapper\",children:[/*#__PURE__*/_jsx(DatePicker,{selected:dateFin,onChange:date=>setDateFin(date),locale:\"fr\",dateFormat:\"dd/MM/yyyy\",placeholderText:\"JJ/MM/AAAA\",className:\"custom-datepicker-input\",popperPlacement:\"bottom-start\",popperModifiers:[{name:'offset',options:{offset:[0,8]},fn:state=>state}],showMonthDropdown:true,showYearDropdown:true,dropdownMode:\"select\",isClearable:true}),/*#__PURE__*/_jsx(\"span\",{className:\"custom-datepicker-icon\",children:\"\\uD83D\\uDCC5\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"search-group\",style:{display:'flex',flexDirection:'column',gap:'5px'},children:[/*#__PURE__*/_jsx(\"label\",{children:\"Sites:\"}),/*#__PURE__*/_jsxs(\"select\",{className:\"select-input\",value:site,onChange:e=>setSite(e.target.value),style:{padding:'8px 12px',borderRadius:'4px',border:'1px solid #ccc',fontSize:'14px',width:'160px',backgroundColor:'white'},title:\"Filtrer par site\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Tous\"}),sites.map(s=>/*#__PURE__*/_jsx(\"option\",{value:s.id,children:s.nom},s.id))]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"search-group\",style:{display:'flex',flexDirection:'column',gap:'5px'},children:[/*#__PURE__*/_jsx(\"label\",{children:\"Tourn\\xE9es:\"}),/*#__PURE__*/_jsxs(\"select\",{className:\"select-input\",value:tournee,onChange:e=>setTournee(e.target.value),style:{padding:'8px 12px',borderRadius:'4px',border:'1px solid #ccc',fontSize:'14px',width:'160px',backgroundColor:'white'},title:\"Filtrer par tourn\\xE9e\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Toutes\"}),tournees.map(t=>/*#__PURE__*/_jsx(\"option\",{value:t.id,children:t.nom},t.id))]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"search-group\",style:{display:'flex',flexDirection:'column',gap:'5px'},children:[/*#__PURE__*/_jsx(\"label\",{children:\"V\\xE9hicules:\"}),/*#__PURE__*/_jsxs(\"select\",{className:\"select-input\",value:vehicule,onChange:e=>setVehicule(e.target.value),style:{padding:'8px 12px',borderRadius:'4px',border:'1px solid #ccc',fontSize:'14px',width:'160px',backgroundColor:'white'},title:\"Filtrer par v\\xE9hicule\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Tous\"}),vehicules.map(v=>/*#__PURE__*/_jsx(\"option\",{value:v.id,children:v.immatriculation},v.id))]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"search-group\",style:{display:'flex',flexDirection:'column',gap:'5px'},children:[/*#__PURE__*/_jsx(\"label\",{children:\"Statut:\"}),/*#__PURE__*/_jsxs(\"select\",{className:\"select-input\",value:statut,onChange:e=>setStatut(e.target.value),style:{padding:'8px 12px',borderRadius:'4px',border:'1px solid #ccc',fontSize:'14px',width:'160px',backgroundColor:'white'},title:\"Filtrer par statut\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Tous\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Livr\\xE9\",children:\"Livr\\xE9\"}),/*#__PURE__*/_jsx(\"option\",{value:\"En cours\",children:\"En cours\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"search-group\",style:{display:'flex',flexDirection:'column',gap:'5px'},children:[/*#__PURE__*/_jsx(\"label\",{children:\"ID Colis:\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",className:\"text-input\",placeholder:\"ID Colis\",value:idColis,onChange:e=>setIdColis(e.target.value),style:{padding:'8px 12px',borderRadius:'4px',border:'1px solid #ccc',fontSize:'14px',width:'160px'},title:\"Filtrer par ID de colis\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"search-buttons\",style:{display:'flex',justifyContent:'flex-start',marginTop:'15px'},children:[/*#__PURE__*/_jsxs(\"button\",{className:\"search-button\",onClick:handleSearch,style:{backgroundColor:'#1976d2',color:'white',padding:'10px 20px',border:'none',borderRadius:'4px',cursor:'pointer',fontSize:'14px',fontWeight:'bold',boxShadow:'0 2px 4px rgba(0,0,0,0.1)',transition:'all 0.2s ease',display:'flex',alignItems:'center',justifyContent:'center',marginRight:'10px'},onMouseOver:e=>e.currentTarget.style.backgroundColor='#1565c0',onMouseOut:e=>e.currentTarget.style.backgroundColor='#1976d2',children:[/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-search\",style:{marginRight:'8px'}}),\" Rechercher\"]}),/*#__PURE__*/_jsxs(\"button\",{className:\"reset-button\",onClick:resetFilters,style:{backgroundColor:'#f5f5f5',color:'#333',padding:'10px 20px',border:'1px solid #ccc',borderRadius:'4px',cursor:'pointer',fontSize:'14px',fontWeight:'bold',transition:'all 0.2s ease',display:'flex',alignItems:'center',justifyContent:'center'},onMouseOver:e=>e.currentTarget.style.backgroundColor='#e0e0e0',onMouseOut:e=>e.currentTarget.style.backgroundColor='#f5f5f5',children:[/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-undo\",style:{marginRight:'8px'}}),\" R\\xE9initialiser\"]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"passages-table-container\",style:{overflowX:'auto'},children:[/*#__PURE__*/_jsx(\"div\",{className:\"results-info\",children:/*#__PURE__*/_jsxs(\"p\",{children:[filteredPassages.length,\" r\\xE9sultat(s) trouv\\xE9(s)\",quickSearch?` pour la recherche \"${quickSearch}\"`:'']})}),/*#__PURE__*/_jsx(\"div\",{className:\"table-container\",children:/*#__PURE__*/_jsxs(\"table\",{className:\"data-table\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[editMode&&/*#__PURE__*/_jsx(\"th\",{children:/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",checked:selectedPassages.length===filteredPassages.length,onChange:e=>{if(e.target.checked){setSelectedPassages(filteredPassages.map(passage=>passage.id));}else{setSelectedPassages([]);}},title:\"S\\xE9lectionner/D\\xE9s\\xE9lectionner tous les passages\",\"aria-label\":\"S\\xE9lectionner tous les passages\"})}),/*#__PURE__*/_jsx(\"th\",{children:\"P\\xD4LE\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Site de d\\xE9part\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Date\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Heure\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Status\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Site d'arriv\\xE9e\"}),/*#__PURE__*/_jsx(\"th\",{children:\"V\\xE9hicule\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Coursier\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Commentaire\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:filteredPassages.map(passage=>{var _editingPassages$pass,_editingPassages$pass2,_editingPassages$pass3,_editingPassages$pass4,_convertTimestampToDa,_editingPassages$pass6,_editingPassages$pass7,_editingPassages$pass8,_editingPassages$pass9,_editingPassages$pass10,_editingPassages$pass11;return/*#__PURE__*/_jsxs(\"tr\",{className:selectedPassages.includes(passage.id)?'selected-row':'',children:[editMode&&/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",checked:selectedPassages.includes(passage.id),onChange:()=>togglePassageSelection(passage.id),title:`Sélectionner le passage ${passage.id}`,\"aria-label\":`Sélectionner le passage ${passage.id}`})}),/*#__PURE__*/_jsx(\"td\",{children:editMode?/*#__PURE__*/_jsx(PoleSelector,{value:((_editingPassages$pass=editingPassages[passage.id])===null||_editingPassages$pass===void 0?void 0:_editingPassages$pass.pole)||passage.pole||'',onChange:value=>handleCellChange(passage.id,'pole',value),placeholder:\"S\\xE9lectionner un p\\xF4le\",style:{width:'100%'},showSearch:true,allowClear:true,title:\"P\\xF4le du passage\"}):getPoleNameById(passage.pole)}),/*#__PURE__*/_jsx(\"td\",{children:editMode?/*#__PURE__*/_jsxs(\"select\",{value:((_editingPassages$pass2=editingPassages[passage.id])===null||_editingPassages$pass2===void 0?void 0:_editingPassages$pass2.siteDepart)||passage.siteDepart,onChange:e=>handleCellChange(passage.id,'siteDepart',e.target.value),className:\"inline-edit-select\",title:\"S\\xE9lectionner un site de d\\xE9part\",\"aria-label\":\"Site de d\\xE9part\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"S\\xE9lectionner un site\"}),sites.map(site=>/*#__PURE__*/_jsx(\"option\",{value:site.id,children:site.nom},site.id))]}):getSiteName(passage.siteDepart)}),/*#__PURE__*/_jsx(\"td\",{children:editMode?/*#__PURE__*/_jsx(\"input\",{type:\"date\",value:formatDateForInput(convertTimestampToDate(((_editingPassages$pass3=editingPassages[passage.id])===null||_editingPassages$pass3===void 0?void 0:_editingPassages$pass3.dateHeureDepart)||passage.dateHeureDepart)),onChange:e=>{const newDate=new Date(e.target.value);handleCellChange(passage.id,'dateHeureDepart',Timestamp.fromDate(newDate));},className:\"inline-edit-input\",onClick:e=>e.stopPropagation()}):formatDateFr(convertTimestampToDate(passage.dateHeureDepart))}),/*#__PURE__*/_jsx(\"td\",{children:editMode?/*#__PURE__*/_jsx(\"input\",{type:\"time\",value:convertTimestampToTime(((_editingPassages$pass4=editingPassages[passage.id])===null||_editingPassages$pass4===void 0?void 0:_editingPassages$pass4.dateHeureDepart)||passage.dateHeureDepart),onChange:e=>{var _editingPassages$pass5;// Préserver la date mais changer l'heure\nconst currentDate=convertTimestampToDate(((_editingPassages$pass5=editingPassages[passage.id])===null||_editingPassages$pass5===void 0?void 0:_editingPassages$pass5.dateHeureDepart)||passage.dateHeureDepart);if(currentDate){const[hours,minutes]=e.target.value.split(':').map(Number);currentDate.setHours(hours,minutes);handleCellChange(passage.id,'dateHeureDepart',Timestamp.fromDate(currentDate));}},className:\"inline-edit-input\",onClick:e=>e.stopPropagation()}):passage.dateHeureDepart?(_convertTimestampToDa=convertTimestampToDate(passage.dateHeureDepart))===null||_convertTimestampToDa===void 0?void 0:_convertTimestampToDa.toLocaleTimeString('fr-FR',{hour:'2-digit',minute:'2-digit'}):''}),/*#__PURE__*/_jsx(\"td\",{children:editMode?/*#__PURE__*/_jsxs(\"select\",{value:((_editingPassages$pass6=editingPassages[passage.id])===null||_editingPassages$pass6===void 0?void 0:_editingPassages$pass6.statut)||passage.statut,onChange:e=>handleCellChange(passage.id,'statut',e.target.value),className:\"inline-edit-select\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"Livr\\xE9\",children:\"Livr\\xE9\"}),/*#__PURE__*/_jsx(\"option\",{value:\"En cours\",children:\"En cours\"})]}):/*#__PURE__*/_jsx(\"span\",{className:passage.statut==='Livré'?'livré':'en-cours',children:passage.statut})}),/*#__PURE__*/_jsx(\"td\",{children:editMode?/*#__PURE__*/_jsxs(\"select\",{value:((_editingPassages$pass7=editingPassages[passage.id])===null||_editingPassages$pass7===void 0?void 0:_editingPassages$pass7.siteFin)||passage.siteFin,onChange:e=>handleCellChange(passage.id,'siteFin',e.target.value),className:\"inline-edit-select\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"S\\xE9lectionner un site\"}),sites.map(site=>/*#__PURE__*/_jsx(\"option\",{value:site.nom,children:site.nom},site.id))]}):getSiteName(passage.siteFin)}),/*#__PURE__*/_jsx(\"td\",{children:editMode?/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:((_editingPassages$pass8=editingPassages[passage.id])===null||_editingPassages$pass8===void 0?void 0:_editingPassages$pass8.coursierChargement)||passage.coursierChargement||'',onChange:e=>handleCellChange(passage.id,'coursierChargement',e.target.value),className:\"inline-edit-input\"}):passage.coursierChargement||'-'}),/*#__PURE__*/_jsx(\"td\",{children:editMode?/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:((_editingPassages$pass9=editingPassages[passage.id])===null||_editingPassages$pass9===void 0?void 0:_editingPassages$pass9.coursierLivraison)||passage.coursierLivraison||'',onChange:e=>handleCellChange(passage.id,'coursierLivraison',e.target.value),className:\"inline-edit-input\"}):passage.coursierLivraison||'-'}),/*#__PURE__*/_jsx(\"td\",{children:editMode?/*#__PURE__*/_jsxs(\"select\",{value:((_editingPassages$pass10=editingPassages[passage.id])===null||_editingPassages$pass10===void 0?void 0:_editingPassages$pass10.tourneeId)||passage.tourneeId,onChange:e=>handleCellChange(passage.id,'tourneeId',e.target.value),className:\"inline-edit-select\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"S\\xE9lectionner une tourn\\xE9e\"}),tournees.map(tournee=>/*#__PURE__*/_jsx(\"option\",{value:tournee.id,children:tournee.nom},tournee.id))]}):getTourneeName(passage.tourneeId)}),/*#__PURE__*/_jsx(\"td\",{children:editMode?/*#__PURE__*/_jsxs(\"select\",{value:((_editingPassages$pass11=editingPassages[passage.id])===null||_editingPassages$pass11===void 0?void 0:_editingPassages$pass11.vehiculeId)||passage.vehiculeId,onChange:e=>handleCellChange(passage.id,'vehiculeId',e.target.value),className:\"inline-edit-select\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"S\\xE9lectionner un v\\xE9hicule\"}),vehicules.map(vehicule=>/*#__PURE__*/_jsx(\"option\",{value:vehicule.id,children:vehicule.immatriculation},vehicule.id))]}):getVehiculeImmatriculation(passage.vehiculeId)})]},passage.id);})})]})})]})]});};export default Passages;","map":{"version":3,"names":["React","useState","useEffect","db","collection","getDocs","Timestamp","deleteDoc","doc","updateDoc","DatePicker","registerLocale","fr","usePoles","PoleSelector","PoleFilter","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","datepickerStyles","Passages","passages","setPassages","allPassages","setAllPassages","loading","setLoading","error","setError","tournees","setTournees","sites","setSites","vehicules","setVehicules","dateDebut","setDateDebut","dateFin","setDateFin","tournee","setTournee","statut","setStatut","site","setSite","vehicule","setVehicule","idColis","setIdColis","quickSearch","setQuickSearch","filteredPassages","setFilteredPassages","selectedPole","setSelectedPole","editMode","setEditMode","selectedPassages","setSelectedPassages","editingPassages","setEditingPassages","poles","fetchPassages","fetchTournees","fetchSites","fetchVehicules","document","documentElement","lang","styleElement","createElement","textContent","head","appendChild","removeChild","results","filter","passage","pole","trim","searchTerm","toLowerCase","getSiteName","siteDepart","includes","siteFin","coursierChargement","coursierLivraison","getTourneeName","tourneeId","getVehiculeImmatriculation","vehiculeId","formatDateFr","convertTimestampToDate","dateHeureDepart","timestamp","Date","toDate","seconds","nanoseconds","console","compareDatesOnly","date1","date2","onlyDate1","getFullYear","getMonth","getDate","onlyDate2","getTime","isDateGreaterOrEqual","isDateLessOrEqual","passagesRef","passagesSnapshot","empty","log","docs","length","forEach","index","id","data","passagesData","map","Object","keys","normalizedData","siteDépart","dhDépart","dateHeureFin","dhLivraison","coursierCharg","véhicule","tournée","tourneesRef","snapshot","tourneesData","nom","date","fromDate","heureDepart","heureFinPrevue","heureFinReelle","coursier","nombreColis","defaultTournees","sitesRef","sitesData","adresse","ville","codePostal","telephone","email","type","defaultSites","vehiculesRef","vehiculesData","immatriculation","marque","modele","annee","dernierEntretien","coursierAssigne","kilometrage","defaultVehicules","foundTournee","find","t","siteId","foundSite","s","foundVehicule","v","day","toString","padStart","month","year","getPoleNameById","poleId","p","handlePoleChange","handleSearch","filteredResults","passageDate","resetFilters","handleDeleteSelected","alert","window","confirm","deletePromises","Promise","all","toggleEditMode","initialEditState","saveAllChanges","then","catch","updatePromises","entries","_ref","updateData","undefined","allSettled","fulfilled","result","status","rejected","warn","handleCellChange","field","value","formatDateForInput","convertTimestampToTime","hours","getHours","minutes","getMinutes","togglePassageSelection","passageId","className","children","onClick","style","marginLeft","disabled","placeholder","onChange","e","target","title","onPoleChange","label","display","flexWrap","gap","flexDirection","selected","locale","dateFormat","placeholderText","popperPlacement","popperModifiers","name","options","offset","fn","state","showMonthDropdown","showYearDropdown","dropdownMode","isClearable","padding","borderRadius","border","fontSize","width","backgroundColor","justifyContent","marginTop","color","cursor","fontWeight","boxShadow","transition","alignItems","marginRight","onMouseOver","currentTarget","onMouseOut","overflowX","checked","_editingPassages$pass","_editingPassages$pass2","_editingPassages$pass3","_editingPassages$pass4","_convertTimestampToDa","_editingPassages$pass6","_editingPassages$pass7","_editingPassages$pass8","_editingPassages$pass9","_editingPassages$pass10","_editingPassages$pass11","showSearch","allowClear","newDate","stopPropagation","_editingPassages$pass5","currentDate","split","Number","setHours","toLocaleTimeString","hour","minute"],"sources":["C:/Users/LS_110/Documents/GitHub/inovie-SCAN-web-main/src/components/Passages.tsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { db } from '../config/firebase';\nimport { collection, getDocs, Timestamp, deleteDoc, doc, updateDoc } from 'firebase/firestore';\nimport DatePicker from 'react-datepicker';\nimport { registerLocale } from 'react-datepicker';\nimport { fr } from 'date-fns/locale/fr';\nimport \"react-datepicker/dist/react-datepicker.css\";\nimport './Passages.css';\nimport './EditMode.css';\nimport { usePoles } from '../services/PoleService';\nimport PoleSelector from './PoleSelector';\nimport PoleFilter from './PoleFilter';\n\n// Enregistrer la locale française\nregisterLocale('fr', fr);\n\n// Styles personnalisés pour le datepicker\nconst datepickerStyles = `\n  .react-datepicker {\n    font-family: 'Roboto', sans-serif;\n    border-radius: 8px;\n    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);\n    border: 1px solid #e0e0e0;\n    z-index: 1000;\n  }\n  \n  .react-datepicker-popper {\n    z-index: 1000;\n  }\n  \n  .react-datepicker__header {\n    background-color: #1976d2;\n    border-bottom: none;\n    border-top-left-radius: 8px;\n    border-top-right-radius: 8px;\n    padding-top: 10px;\n  }\n  \n  .react-datepicker__current-month {\n    color: white;\n    font-weight: 500;\n    font-size: 1rem;\n    padding-bottom: 5px;\n  }\n  \n  .react-datepicker__day-name {\n    color: white;\n    font-weight: 500;\n  }\n  \n  .react-datepicker__day--selected {\n    background-color: #1976d2;\n    border-radius: 50%;\n  }\n  \n  .react-datepicker__day:hover {\n    background-color: #e8f0fe;\n    border-radius: 50%;\n  }\n  \n  .react-datepicker__day--keyboard-selected {\n    background-color: #e8f0fe;\n    color: #1976d2;\n    border-radius: 50%;\n  }\n  \n  .react-datepicker__navigation {\n    top: 12px;\n  }\n  \n  .react-datepicker__navigation-icon::before {\n    border-color: white;\n  }\n  \n  .react-datepicker__day--today {\n    font-weight: bold;\n    color: #1976d2;\n  }\n  \n  .custom-datepicker-input {\n    width: 160px;\n    padding: 10px 12px;\n    border-radius: 4px;\n    border: 1px solid #ccc;\n    font-size: 14px;\n    cursor: pointer;\n    background-color: white;\n    transition: all 0.2s ease;\n    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);\n  }\n  \n  .custom-datepicker-input:focus {\n    outline: none;\n    border-color: #1976d2;\n    box-shadow: 0 0 0 2px rgba(25, 118, 210, 0.2);\n  }\n  \n  .custom-datepicker-input::placeholder {\n    color: #aaa;\n  }\n  \n  .custom-datepicker-wrapper {\n    position: relative;\n  }\n  \n  .custom-datepicker-icon {\n    position: absolute;\n    right: 10px;\n    top: 50%;\n    transform: translateY(-50%);\n    color: #666;\n    pointer-events: none;\n  }\n`;\n\ninterface Passage {\n  id: string;\n  siteDepart: string;\n  dateHeureDepart: Timestamp | any; // Accepter différents formats pour la compatibilité\n  idColis: string;\n  statut: 'Livré' | 'En cours';\n  siteFin?: string;\n  dateHeureFin?: Timestamp | any; // Accepter différents formats pour la compatibilité\n  coursierChargement?: string;\n  coursierLivraison?: string;\n  vehiculeId?: string;\n  tourneeId?: string;\n  heureDebut?: string;\n  heureFin?: string;\n  pole?: string;\n}\n\ninterface Tournee {\n  id: string;\n  nom: string;\n  date: Timestamp;\n  heureDepart: string;\n  heureFinPrevue: string;\n  heureFinReelle?: string;\n  coursier: string;\n  vehicule: string;\n  nombreColis: number;\n  statut: 'en_attente' | 'en_cours' | 'terminee' | 'annulee';\n  siteDepart: string;\n}\n\ninterface Site {\n  id: string;\n  nom: string;\n  adresse: string;\n  ville: string;\n  codePostal: string;\n  telephone: string;\n  email: string;\n  type: string;\n  statut: 'actif' | 'inactif';\n}\n\ninterface Vehicule {\n  id: string;\n  immatriculation: string;\n  marque: string;\n  modele: string;\n  type: string;\n  annee: number;\n  statut: 'actif' | 'maintenance' | 'inactif';\n  dernierEntretien?: string;\n  coursierAssigne?: string;\n  kilometrage: number;\n}\n\nconst Passages: React.FC = () => {\n  const [passages, setPassages] = useState<Passage[]>([]);\n  const [allPassages, setAllPassages] = useState<Passage[]>([]); \n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState<string | null>(null);\n  const [tournees, setTournees] = useState<Tournee[]>([]);\n  const [sites, setSites] = useState<Site[]>([]);\n  const [vehicules, setVehicules] = useState<Vehicule[]>([]);\n  \n  // Filtres\n  const [dateDebut, setDateDebut] = useState<Date | null>(null);\n  const [dateFin, setDateFin] = useState<Date | null>(null);\n  const [tournee, setTournee] = useState<string>('');\n  const [statut, setStatut] = useState<string>('');\n  const [site, setSite] = useState<string>('');\n  const [vehicule, setVehicule] = useState<string>('');\n  const [idColis, setIdColis] = useState<string>('');\n  \n  // Recherche rapide\n  const [quickSearch, setQuickSearch] = useState<string>('');\n  const [filteredPassages, setFilteredPassages] = useState<Passage[]>([]);\n\n  // Ajout du filtre par pôle\n  const [selectedPole, setSelectedPole] = useState<string>('');\n\n  // Ajout des états pour le mode édition et la sélection multiple\n  const [editMode, setEditMode] = useState(false);\n  const [selectedPassages, setSelectedPassages] = useState<string[]>([]);\n  const [editingPassages, setEditingPassages] = useState<{[key: string]: Passage}>({});\n\n  // Utilisation du hook usePoles\n  const { poles } = usePoles();\n\n  useEffect(() => {\n    fetchPassages();\n    fetchTournees();\n    fetchSites();\n    fetchVehicules();\n    \n    // Ajouter l'attribut lang=\"fr\" au document pour les calendriers en français\n    document.documentElement.lang = 'fr';\n    \n    // Ajouter les styles personnalisés pour le datepicker\n    const styleElement = document.createElement('style');\n    styleElement.textContent = datepickerStyles;\n    document.head.appendChild(styleElement);\n    \n    return () => {\n      // Nettoyage\n      document.documentElement.lang = '';\n      document.head.removeChild(styleElement);\n    };\n  }, []);\n\n  // Initialiser les passages filtrés au chargement\n  useEffect(() => {\n    setFilteredPassages(passages);\n  }, [passages]);\n\n  // Effet pour filtrer les passages en fonction de la recherche rapide et du pôle sélectionné\n  useEffect(() => {\n    let results = passages;\n\n    // Filtrer par pôle si un pôle est sélectionné\n    if (selectedPole) {\n      results = results.filter(passage => passage.pole === selectedPole);\n    }\n\n    // Ensuite filtrer par recherche rapide\n    if (quickSearch.trim()) {\n      const searchTerm = quickSearch.toLowerCase().trim();\n      results = results.filter(passage => {\n        // Rechercher dans tous les champs textuels du passage\n        return (\n          getSiteName(passage.siteDepart).toLowerCase().includes(searchTerm) ||\n          getSiteName(passage.siteFin || '').toLowerCase().includes(searchTerm) ||\n          passage.idColis.toLowerCase().includes(searchTerm) ||\n          passage.statut.toLowerCase().includes(searchTerm) ||\n          (passage.coursierChargement || '').toLowerCase().includes(searchTerm) ||\n          (passage.coursierLivraison || '').toLowerCase().includes(searchTerm) ||\n          getTourneeName(passage.tourneeId).toLowerCase().includes(searchTerm) ||\n          getVehiculeImmatriculation(passage.vehiculeId).toLowerCase().includes(searchTerm) ||\n          formatDateFr(convertTimestampToDate(passage.dateHeureDepart)).includes(searchTerm)\n        );\n      });\n    }\n\n    setFilteredPassages(results);\n  }, [quickSearch, passages, selectedPole]);\n\n  // Fonction pour convertir un Timestamp Firebase en Date JavaScript\n  const convertTimestampToDate = (timestamp: any): Date | null => {\n    if (!timestamp) return null;\n    \n    // Si c'est déjà un objet Date\n    if (timestamp instanceof Date) return timestamp;\n    \n    // Si c'est un Timestamp Firebase avec la méthode toDate()\n    if (timestamp && typeof timestamp.toDate === 'function') {\n      return timestamp.toDate();\n    }\n    \n    // Si c'est un objet avec seconds et nanoseconds (format Firestore)\n    if (timestamp && 'seconds' in timestamp && 'nanoseconds' in timestamp) {\n      return new Date(timestamp.seconds * 1000 + timestamp.nanoseconds / 1000000);\n    }\n    \n    // Si c'est un nombre (timestamp en millisecondes)\n    if (typeof timestamp === 'number') {\n      return new Date(timestamp);\n    }\n    \n    // Si c'est une chaîne de caractères\n    if (typeof timestamp === 'string') {\n      return new Date(timestamp);\n    }\n    \n    console.error('Format de timestamp non reconnu:', timestamp);\n    return null;\n  };\n\n  // Fonction pour comparer uniquement les dates (sans l'heure)\n  const compareDatesOnly = (date1: Date | null, date2: Date | null): boolean => {\n    if (!date1 || !date2) return false;\n    \n    // Créer de nouvelles dates avec uniquement l'année, le mois et le jour\n    const onlyDate1 = new Date(date1.getFullYear(), date1.getMonth(), date1.getDate());\n    const onlyDate2 = new Date(date2.getFullYear(), date2.getMonth(), date2.getDate());\n    \n    // Comparer les timestamps (en millisecondes)\n    return onlyDate1.getTime() === onlyDate2.getTime();\n  };\n  \n  // Fonction pour vérifier si une date est supérieure ou égale à une autre (sans l'heure)\n  const isDateGreaterOrEqual = (date1: Date | null, date2: Date | null): boolean => {\n    if (!date1 || !date2) return false;\n    \n    // Créer de nouvelles dates avec uniquement l'année, le mois et le jour\n    const onlyDate1 = new Date(date1.getFullYear(), date1.getMonth(), date1.getDate());\n    const onlyDate2 = new Date(date2.getFullYear(), date2.getMonth(), date2.getDate());\n    \n    // Comparer les timestamps (en millisecondes)\n    return onlyDate1.getTime() >= onlyDate2.getTime();\n  };\n  \n  // Fonction pour vérifier si une date est inférieure ou égale à une autre (sans l'heure)\n  const isDateLessOrEqual = (date1: Date | null, date2: Date | null): boolean => {\n    if (!date1 || !date2) return false;\n    \n    // Créer de nouvelles dates avec uniquement l'année, le mois et le jour\n    const onlyDate1 = new Date(date1.getFullYear(), date1.getMonth(), date1.getDate());\n    const onlyDate2 = new Date(date2.getFullYear(), date2.getMonth(), date2.getDate());\n    \n    // Comparer les timestamps (en millisecondes)\n    return onlyDate1.getTime() <= onlyDate2.getTime();\n  };\n\n  const fetchPassages = async () => {\n    try {\n      setLoading(true);\n      setError(null);\n      \n      // Récupérer les données depuis Firebase\n      const passagesRef = collection(db, 'passages');\n      const passagesSnapshot = await getDocs(passagesRef);\n      \n      if (passagesSnapshot.empty) {\n        console.log('Aucun passage trouvé dans Firebase');\n        setError('Aucun passage trouvé. Veuillez initialiser les données.');\n        setLoading(false);\n        return;\n      }\n      \n      console.log('Nombre de documents récupérés:', passagesSnapshot.docs.length);\n      \n      // Afficher les données brutes pour comprendre la structure\n      console.log('Données brutes de Firebase:');\n      passagesSnapshot.docs.forEach((doc, index) => {\n        console.log(`Document ${index + 1} (ID: ${doc.id}):`, doc.data());\n      });\n      \n      const passagesData = passagesSnapshot.docs.map(doc => {\n        const data = doc.data();\n        \n        // Vérifier les propriétés exactes des données\n        console.log('Propriétés du document:', Object.keys(data));\n        \n        // Normaliser les noms de propriétés\n        const normalizedData = {\n          id: doc.id,\n          siteDepart: data.siteDépart || data.siteDepart || '',\n          dateHeureDepart: data.dhDépart || data.dateHeureDepart,\n          idColis: data.idColis || '',\n          statut: data.statut || 'En cours',\n          siteFin: data.siteFin || '',\n          dateHeureFin: data.dhLivraison || data.dateHeureFin,\n          coursierChargement: data.coursierCharg || data.coursierChargement || '',\n          coursierLivraison: data.coursierLivraison || '',\n          vehiculeId: data.véhicule || data.vehiculeId || '',\n          tourneeId: data.tournée || data.tourneeId || '',\n          pole: data.pole || '',\n        } as Passage;\n        \n        return normalizedData;\n      });\n      \n      console.log('Données récupérées de Firebase (après normalisation):', passagesData);\n      \n      setAllPassages(passagesData);\n      setPassages(passagesData);\n      setLoading(false);\n    } catch (error) {\n      console.error('Erreur lors de la récupération des passages:', error);\n      setError('Erreur lors de la récupération des données');\n      setLoading(false);\n    }\n  };\n\n  // Fonction pour récupérer les tournées depuis Firebase\n  const fetchTournees = async () => {\n    try {\n      const tourneesRef = collection(db, 'tournees');\n      const snapshot = await getDocs(tourneesRef);\n      \n      if (!snapshot.empty) {\n        const tourneesData = snapshot.docs.map(doc => {\n          const data = doc.data();\n          return {\n            id: doc.id,\n            nom: data.nom || '',\n            date: data.date || Timestamp.fromDate(new Date()),\n            heureDepart: data.heureDepart || '',\n            heureFinPrevue: data.heureFinPrevue || '',\n            heureFinReelle: data.heureFinReelle || '',\n            coursier: data.coursier || '',\n            vehicule: data.vehicule || '',\n            nombreColis: data.nombreColis || 0,\n            statut: data.statut || 'en_attente',\n            siteDepart: data.siteDepart || ''\n          } as Tournee;\n        });\n        \n        setTournees(tourneesData);\n      } else {\n        console.log(\"Aucune tournée trouvée dans Firebase\");\n        // Définir quelques tournées par défaut si aucune n'est trouvée\n        const defaultTournees = [\n          {\n            id: '1',\n            nom: 'Matin',\n            date: Timestamp.fromDate(new Date()),\n            heureDepart: '07:00',\n            heureFinPrevue: '12:00',\n            coursier: 'Sébastien Lherlier',\n            vehicule: 'GE-695-RT',\n            nombreColis: 15,\n            statut: 'en_attente' as const,\n            siteDepart: 'Laboratoire Central'\n          },\n          {\n            id: '2',\n            nom: 'Jour',\n            date: Timestamp.fromDate(new Date()),\n            heureDepart: '12:00',\n            heureFinPrevue: '17:00',\n            coursier: 'Guillaume Sage',\n            vehicule: 'GI-456-AD',\n            nombreColis: 12,\n            statut: 'en_attente' as const,\n            siteDepart: 'Laboratoire Purpan'\n          },\n          {\n            id: '3',\n            nom: 'Soir',\n            date: Timestamp.fromDate(new Date()),\n            heureDepart: '17:00',\n            heureFinPrevue: '22:00',\n            coursier: 'Sébastien Lherlier',\n            vehicule: 'GE-695-RT',\n            nombreColis: 10,\n            statut: 'en_attente' as const,\n            siteDepart: 'Laboratoire Central'\n          }\n        ];\n        setTournees(defaultTournees);\n      }\n    } catch (error) {\n      console.error('Erreur lors de la récupération des tournées:', error);\n    }\n  };\n\n  // Fonction pour récupérer les sites depuis Firebase\n  const fetchSites = async () => {\n    try {\n      const sitesRef = collection(db, 'sites');\n      const snapshot = await getDocs(sitesRef);\n      \n      if (!snapshot.empty) {\n        const sitesData = snapshot.docs.map(doc => {\n          const data = doc.data();\n          return {\n            id: doc.id,\n            nom: data.nom || '',\n            adresse: data.adresse || '',\n            ville: data.ville || '',\n            codePostal: data.codePostal || '',\n            telephone: data.telephone || '',\n            email: data.email || '',\n            type: data.type || '',\n            statut: data.statut || 'actif'\n          } as Site;\n        });\n        \n        setSites(sitesData);\n      } else {\n        console.log(\"Aucun site trouvé dans Firebase\");\n        // Définir quelques sites par défaut si aucun n'est trouvé\n        const defaultSites = [\n          {\n            id: '1',\n            nom: 'Laboratoire Central',\n            adresse: '15 rue des Sciences',\n            ville: 'Toulouse',\n            codePostal: '31000',\n            telephone: '05.61.XX.XX.XX',\n            email: 'contact@labo-central.fr',\n            type: 'Laboratoire',\n            statut: 'actif' as const\n          },\n          {\n            id: '2',\n            nom: 'Laboratoire Purpan',\n            adresse: '330 avenue de Grande Bretagne',\n            ville: 'Toulouse',\n            codePostal: '31300',\n            telephone: '05.61.XX.XX.XX',\n            email: 'contact@labo-purpan.fr',\n            type: 'Laboratoire',\n            statut: 'actif' as const\n          }\n        ];\n        setSites(defaultSites);\n      }\n    } catch (error) {\n      console.error('Erreur lors de la récupération des sites:', error);\n    }\n  };\n\n  // Fonction pour récupérer les véhicules depuis Firebase\n  const fetchVehicules = async () => {\n    try {\n      const vehiculesRef = collection(db, 'vehicules');\n      const snapshot = await getDocs(vehiculesRef);\n      \n      if (!snapshot.empty) {\n        const vehiculesData = snapshot.docs.map(doc => {\n          const data = doc.data();\n          return {\n            id: doc.id,\n            immatriculation: data.immatriculation || '',\n            marque: data.marque || '',\n            modele: data.modele || '',\n            type: data.type || '',\n            annee: data.annee || 2023,\n            statut: data.statut || 'actif',\n            dernierEntretien: data.dernierEntretien || '',\n            coursierAssigne: data.coursierAssigne || '',\n            kilometrage: data.kilometrage || 0\n          } as Vehicule;\n        });\n        \n        setVehicules(vehiculesData);\n      } else {\n        console.log(\"Aucun véhicule trouvé dans Firebase\");\n        // Définir quelques véhicules par défaut si aucun n'est trouvé\n        const defaultVehicules = [\n          {\n            id: '1',\n            immatriculation: 'GE-695-RT',\n            marque: 'Renault',\n            modele: 'Kangoo',\n            type: 'Utilitaire',\n            annee: 2020,\n            statut: 'actif' as const,\n            dernierEntretien: '2023-01-15',\n            coursierAssigne: 'Sébastien Lherlier',\n            kilometrage: 45000\n          },\n          {\n            id: '2',\n            immatriculation: 'GI-456-AD',\n            marque: 'Citroën',\n            modele: 'Berlingo',\n            type: 'Utilitaire',\n            annee: 2021,\n            statut: 'actif' as const,\n            dernierEntretien: '2023-02-10',\n            coursierAssigne: 'Guillaume Sage',\n            kilometrage: 32500\n          }\n        ];\n        setVehicules(defaultVehicules);\n      }\n    } catch (error) {\n      console.error('Erreur lors de la récupération des véhicules:', error);\n    }\n  };\n\n  // Fonction pour obtenir le nom de la tournée à partir de son ID\n  const getTourneeName = (tourneeId: string | undefined): string => {\n    if (!tourneeId) return '';\n    const foundTournee = tournees.find(t => t.id === tourneeId);\n    return foundTournee ? foundTournee.nom : tourneeId;\n  };\n\n  // Fonction pour obtenir le nom du site à partir de son ID\n  const getSiteName = (siteId: string | undefined): string => {\n    if (!siteId) return '';\n    const foundSite = sites.find(s => s.id === siteId);\n    return foundSite ? foundSite.nom : siteId;\n  };\n\n  // Fonction pour obtenir l'immatriculation du véhicule à partir de son ID\n  const getVehiculeImmatriculation = (vehiculeId: string | undefined): string => {\n    if (!vehiculeId) return '';\n    const foundVehicule = vehicules.find(v => v.id === vehiculeId);\n    return foundVehicule ? foundVehicule.immatriculation : vehiculeId;\n  };\n\n  // Fonction pour formater une date au format français (JJ/MM/AAAA)\n  const formatDateFr = (date: Date | null): string => {\n    if (!date) return '';\n    const day = date.getDate().toString().padStart(2, '0');\n    const month = (date.getMonth() + 1).toString().padStart(2, '0');\n    const year = date.getFullYear();\n    return `${day}/${month}/${year}`;\n  };\n\n  // Fonction pour obtenir le nom du pôle\n  const getPoleNameById = (poleId: string | undefined): string => {\n    if (!poleId) return '-';\n    const pole = poles.find(p => p.id === poleId);\n    return pole ? pole.nom : poleId;\n  };\n\n  // Fonction pour gérer le changement de pôle\n  const handlePoleChange = (pole: string) => {\n    setSelectedPole(pole);\n  };\n\n  const handleSearch = () => {\n    console.log('Recherche démarrée avec les critères suivants:');\n    console.log('Date début:', dateDebut);\n    console.log('Date fin:', dateFin);\n    console.log('Tournée:', tournee);\n    console.log('Statut:', statut);\n    console.log('Site:', site);\n    console.log('Véhicule:', vehicule);\n    console.log('ID Colis:', idColis);\n    console.log('Nombre total de passages avant filtrage:', allPassages.length);\n    \n    try {\n      // Filtrer les passages en fonction des critères sélectionnés\n      let filteredResults = [...allPassages];\n      \n      // Filtrer par date de début\n      if (dateDebut) {\n        filteredResults = filteredResults.filter(passage => {\n          const passageDate = convertTimestampToDate(passage.dateHeureDepart);\n          return passageDate && isDateGreaterOrEqual(passageDate, dateDebut);\n        });\n      }\n      \n      // Filtrer par date de fin\n      if (dateFin) {\n        filteredResults = filteredResults.filter(passage => {\n          const passageDate = convertTimestampToDate(passage.dateHeureDepart);\n          return passageDate && isDateLessOrEqual(passageDate, dateFin);\n        });\n      }\n      \n      // Filtrer par tournée\n      if (tournee) {\n        filteredResults = filteredResults.filter(passage => passage.tourneeId === tournee);\n      }\n      \n      // Filtrer par statut\n      if (statut) {\n        filteredResults = filteredResults.filter(passage => passage.statut === statut);\n      }\n      \n      // Filtrer par site\n      if (site) {\n        filteredResults = filteredResults.filter(passage => passage.siteDepart === site || passage.siteFin === site);\n      }\n      \n      // Filtrer par véhicule\n      if (vehicule) {\n        filteredResults = filteredResults.filter(passage => passage.vehiculeId === vehicule);\n      }\n      \n      // Filtrer par ID de colis\n      if (idColis) {\n        filteredResults = filteredResults.filter(passage => \n          passage.idColis && passage.idColis.toLowerCase().includes(idColis.toLowerCase())\n        );\n      }\n      \n      console.log('Nombre de passages après filtrage:', filteredResults.length);\n      \n      // Mettre à jour l'état des passages avec les résultats filtrés\n      setPassages(filteredResults);\n    } catch (error) {\n      console.error('Erreur lors de la recherche:', error);\n      setError('Erreur lors de la recherche. Veuillez réessayer.');\n    }\n  };\n\n  const resetFilters = () => {\n    setDateDebut(null);\n    setDateFin(null);\n    setTournee('');\n    setStatut('');\n    setSite('');\n    setVehicule('');\n    setIdColis('');\n    setQuickSearch('');\n    setSelectedPole('');\n    setFilteredPassages(passages);\n  };\n\n  // Ajout de la fonction pour supprimer les passages sélectionnés\n  const handleDeleteSelected = async () => {\n    if (selectedPassages.length === 0) {\n      alert('Veuillez sélectionner au moins un passage à supprimer');\n      return;\n    }\n\n    if (window.confirm(`Êtes-vous sûr de vouloir supprimer ${selectedPassages.length} passage(s) ?`)) {\n      try {\n        // Supprimer les passages sélectionnés de Firestore\n        const deletePromises = selectedPassages.map(id => deleteDoc(doc(db, 'passages', id)));\n        await Promise.all(deletePromises);\n        \n        // Mettre à jour l'état local\n        setPassages(passages.filter(passage => !selectedPassages.includes(passage.id)));\n        setSelectedPassages([]);\n      } catch (error) {\n        console.error('Erreur lors de la suppression:', error);\n        setError('Erreur lors de la suppression');\n      }\n    }\n  };\n\n  // Fonction pour basculer le mode édition\n  const toggleEditMode = () => {\n    if (!editMode) {\n      // Si on entre en mode édition, initialiser l'état d'édition avec les passages actuels\n      console.log(\"Entrée en mode édition\");\n      const initialEditState: {[key: string]: Passage} = {};\n      passages.forEach(passage => {\n        initialEditState[passage.id] = {...passage};\n      });\n      setEditingPassages(initialEditState);\n      // Activer le mode édition\n      setEditMode(true);\n    } else {\n      // Si on quitte le mode édition, demander confirmation\n      if (window.confirm(\"Voulez-vous enregistrer les modifications ?\")) {\n        console.log(\"Sauvegarde des modifications avant de quitter le mode édition\");\n        // Sauvegarder les modifications et quitter le mode édition après la sauvegarde\n        saveAllChanges().then(() => {\n          // Désélectionner tout et quitter le mode édition\n          setSelectedPassages([]);\n          setEditMode(false);\n        }).catch(error => {\n          console.error(\"Erreur lors de la sauvegarde:\", error);\n          // Laisser l'utilisateur en mode édition en cas d'erreur\n          alert(\"Une erreur est survenue lors de la sauvegarde. Veuillez réessayer.\");\n        });\n      } else {\n        console.log(\"Annulation des modifications et sortie du mode édition\");\n        // Annuler les modifications et quitter le mode édition\n        setEditingPassages({});\n        setSelectedPassages([]);\n        setEditMode(false);\n      }\n    }\n  };\n\n  // Fonction pour sauvegarder toutes les modifications\n  const saveAllChanges = async () => {\n    try {\n      console.log(\"Début de la sauvegarde des modifications...\");\n      console.log(\"Passages à mettre à jour:\", Object.keys(editingPassages).length);\n      \n      // Parcourir tous les passages modifiés et les mettre à jour dans Firestore\n      const updatePromises = Object.entries(editingPassages).map(async ([id, passage]) => {\n        try {\n          console.log(`Mise à jour du passage ${id}:`, passage);\n          \n          // Créer un objet avec uniquement les champs définis\n          const updateData: Partial<Passage> = {};\n          \n          // Vérifier et ajouter chaque champ s'il est défini\n          if (passage.siteDepart !== undefined) updateData.siteDepart = passage.siteDepart;\n          if (passage.dateHeureDepart !== undefined) updateData.dateHeureDepart = passage.dateHeureDepart;\n          if (passage.idColis !== undefined) updateData.idColis = passage.idColis;\n          if (passage.statut !== undefined) updateData.statut = passage.statut;\n          if (passage.siteFin !== undefined) updateData.siteFin = passage.siteFin;\n          if (passage.dateHeureFin !== undefined) updateData.dateHeureFin = passage.dateHeureFin;\n          if (passage.coursierChargement !== undefined) updateData.coursierChargement = passage.coursierChargement;\n          if (passage.coursierLivraison !== undefined) updateData.coursierLivraison = passage.coursierLivraison;\n          if (passage.vehiculeId !== undefined) updateData.vehiculeId = passage.vehiculeId;\n          if (passage.tourneeId !== undefined) updateData.tourneeId = passage.tourneeId;\n          if (passage.pole !== undefined) updateData.pole = passage.pole;\n\n          await updateDoc(doc(db, 'passages', id), updateData);\n          console.log(`Passage ${id} mis à jour avec succès`);\n          return id;\n        } catch (error) {\n          console.error(`Erreur lors de la mise à jour du passage ${id}:`, error);\n          throw error;\n        }\n      });\n      \n      // Attendre que toutes les opérations soient terminées\n      const results = await Promise.allSettled(updatePromises);\n      \n      // Vérifier les résultats\n      const fulfilled = results.filter(result => result.status === 'fulfilled').length;\n      const rejected = results.filter(result => result.status === 'rejected').length;\n      \n      console.log(`Opérations terminées: ${fulfilled} réussies, ${rejected} échouées`);\n      \n      if (rejected > 0) {\n        console.warn(\"Certaines opérations ont échoué. Voir les erreurs ci-dessus.\");\n      }\n      \n      // Mettre à jour l'état local avec les passages modifiés\n      setPassages(passages.map(passage => {\n        if (editingPassages[passage.id]) {\n          return editingPassages[passage.id];\n        }\n        return passage;\n      }));\n      \n      // Rafraîchir les données\n      await fetchPassages();\n      \n      // Réinitialiser les états\n      setEditingPassages({});\n      \n      if (rejected > 0) {\n        alert(`Modifications partiellement enregistrées. ${rejected} opérations ont échoué.`);\n      } else {\n        alert('Modifications enregistrées avec succès');\n      }\n      \n      console.log('Toutes les modifications ont été enregistrées avec succès');\n      return true;\n    } catch (error) {\n      console.error('Erreur lors de la sauvegarde des modifications:', error);\n      alert('Erreur lors de la sauvegarde des modifications. Veuillez réessayer.');\n      throw error;\n    }\n  };\n\n  // Fonction pour gérer les changements de valeur dans les champs d'édition\n  const handleCellChange = (id: string, field: keyof Passage, value: any) => {\n    setEditingPassages({\n      ...editingPassages,\n      [id]: {\n        ...editingPassages[id],\n        [field]: value\n      }\n    });\n  };\n\n  // Fonction pour formater une date pour l'input de type date\n  const formatDateForInput = (date: Date | null): string => {\n    if (!date) return '';\n    const year = date.getFullYear();\n    const month = (date.getMonth() + 1).toString().padStart(2, '0');\n    const day = date.getDate().toString().padStart(2, '0');\n    return `${year}-${month}-${day}`;\n  };\n\n  // Fonction pour convertir un Timestamp en format d'heure pour input time\n  const convertTimestampToTime = (timestamp: any): string => {\n    const date = convertTimestampToDate(timestamp);\n    if (!date) return '';\n    \n    const hours = date.getHours().toString().padStart(2, '0');\n    const minutes = date.getMinutes().toString().padStart(2, '0');\n    \n    return `${hours}:${minutes}`;\n  };\n\n  // Fonction pour sélectionner/désélectionner un passage\n  const togglePassageSelection = (id: string) => {\n    if (selectedPassages.includes(id)) {\n      setSelectedPassages(selectedPassages.filter(passageId => passageId !== id));\n    } else {\n      setSelectedPassages([...selectedPassages, id]);\n    }\n  };\n\n  if (loading) {\n    return (\n      <div className=\"loading-container\">\n        <div className=\"loading-spinner\"></div>\n        <p>Chargement des passages...</p>\n      </div>\n    );\n  }\n\n  if (error) {\n    return (\n      <div className=\"error-container\">\n        <p className=\"error-message\">{error}</p>\n        <button className=\"button\" onClick={fetchPassages}>Réessayer</button>\n      </div>\n    );\n  }\n\n  return (\n    <div>\n      <div className=\"section-header\">\n        <h2 className=\"section-title\">Passages</h2>\n      </div>\n      \n      {/* Conteneur sticky pour les boutons d'action, positionné à droite */}\n      <div className=\"sticky-header-container\">\n        <div className=\"header-actions\">\n          {editMode ? (\n            <>\n              <button \n                className=\"button button-success\" \n                onClick={toggleEditMode}\n              >\n                <i className=\"fas fa-save\"></i> Enregistrer\n              </button>\n              <button \n                className=\"button button-secondary\" \n                onClick={() => {\n                  if (window.confirm(\"Êtes-vous sûr de vouloir annuler toutes les modifications ?\")) {\n                    setEditingPassages({});\n                    setSelectedPassages([]);\n                    setEditMode(false);\n                  }\n                }}\n                style={{ marginLeft: '10px' }}\n              >\n                <i className=\"fas fa-times\"></i> Annuler\n              </button>\n            </>\n          ) : (\n            <button \n              className=\"button\" \n              onClick={toggleEditMode}\n            >\n              <i className=\"fas fa-edit\"></i> Modifier\n            </button>\n          )}\n        </div>\n        \n        {editMode && (\n          <div className=\"edit-actions\">\n            <button \n              className=\"button button-danger\" \n              onClick={handleDeleteSelected}\n              disabled={selectedPassages.length === 0}\n            >\n              <i className=\"fas fa-trash-alt\"></i> Supprimer ({selectedPassages.length})\n            </button>\n          </div>\n        )}\n        \n        <div className=\"quick-search-container\">\n          <input\n            type=\"text\"\n            className=\"quick-search-input\"\n            placeholder=\"Recherche rapide...\"\n            value={quickSearch}\n            onChange={(e) => setQuickSearch(e.target.value)}\n            title=\"Rechercher dans le tableau\"\n          />\n          <div className=\"pole-filter\">\n            <PoleFilter\n              onPoleChange={handlePoleChange}\n              selectedPole={selectedPole}\n              label=\"Filtrer par pôle\"\n              className=\"pole-filter-component\"\n            />\n          </div>\n        </div>\n      </div>\n      \n      {/* Filtres de recherche, positionnés sous le titre */}\n      <div className=\"search-filters-container\">\n        <div className=\"search-filters\" style={{ display: 'flex', flexWrap: 'wrap', gap: '15px' }}>\n          <div className=\"search-group\" style={{ display: 'flex', flexDirection: 'column', gap: '5px' }}>\n            <label>Date début:</label>\n            <div className=\"custom-datepicker-wrapper\">\n              <DatePicker\n                selected={dateDebut}\n                onChange={(date: Date | null) => setDateDebut(date)}\n                locale=\"fr\"\n                dateFormat=\"dd/MM/yyyy\"\n                placeholderText=\"JJ/MM/AAAA\"\n                className=\"custom-datepicker-input\"\n                popperPlacement=\"bottom-start\"\n                popperModifiers={[\n                  {\n                    name: 'offset',\n                    options: {\n                      offset: [0, 8],\n                    },\n                    fn: (state) => state\n                  },\n                ]}\n                showMonthDropdown\n                showYearDropdown\n                dropdownMode=\"select\"\n                isClearable\n              />\n              <span className=\"custom-datepicker-icon\">📅</span>\n            </div>\n          </div>\n          <div className=\"search-group\" style={{ display: 'flex', flexDirection: 'column', gap: '5px' }}>\n            <label>Date fin:</label>\n            <div className=\"custom-datepicker-wrapper\">\n              <DatePicker\n                selected={dateFin}\n                onChange={(date: Date | null) => setDateFin(date)}\n                locale=\"fr\"\n                dateFormat=\"dd/MM/yyyy\"\n                placeholderText=\"JJ/MM/AAAA\"\n                className=\"custom-datepicker-input\"\n                popperPlacement=\"bottom-start\"\n                popperModifiers={[\n                  {\n                    name: 'offset',\n                    options: {\n                      offset: [0, 8],\n                    },\n                    fn: (state) => state\n                  },\n                ]}\n                showMonthDropdown\n                showYearDropdown\n                dropdownMode=\"select\"\n                isClearable\n              />\n              <span className=\"custom-datepicker-icon\">📅</span>\n            </div>\n          </div>\n          <div className=\"search-group\" style={{ display: 'flex', flexDirection: 'column', gap: '5px' }}>\n            <label>Sites:</label>\n            <select \n              className=\"select-input\"\n              value={site}\n              onChange={(e) => setSite(e.target.value)}\n              style={{\n                padding: '8px 12px',\n                borderRadius: '4px',\n                border: '1px solid #ccc',\n                fontSize: '14px',\n                width: '160px',\n                backgroundColor: 'white'\n              }}\n              title=\"Filtrer par site\"\n            >\n              <option value=\"\">Tous</option>\n              {sites.map((s) => (\n                <option key={s.id} value={s.id}>{s.nom}</option>\n              ))}\n            </select>\n          </div>\n          <div className=\"search-group\" style={{ display: 'flex', flexDirection: 'column', gap: '5px' }}>\n            <label>Tournées:</label>\n            <select \n              className=\"select-input\"\n              value={tournee}\n              onChange={(e) => setTournee(e.target.value)}\n              style={{\n                padding: '8px 12px',\n                borderRadius: '4px',\n                border: '1px solid #ccc',\n                fontSize: '14px',\n                width: '160px',\n                backgroundColor: 'white'\n              }}\n              title=\"Filtrer par tournée\"\n            >\n              <option value=\"\">Toutes</option>\n              {tournees.map((t) => (\n                <option key={t.id} value={t.id}>{t.nom}</option>\n              ))}\n            </select>\n          </div>\n          <div className=\"search-group\" style={{ display: 'flex', flexDirection: 'column', gap: '5px' }}>\n            <label>Véhicules:</label>\n            <select \n              className=\"select-input\"\n              value={vehicule}\n              onChange={(e) => setVehicule(e.target.value)}\n              style={{\n                padding: '8px 12px',\n                borderRadius: '4px',\n                border: '1px solid #ccc',\n                fontSize: '14px',\n                width: '160px',\n                backgroundColor: 'white'\n              }}\n              title=\"Filtrer par véhicule\"\n            >\n              <option value=\"\">Tous</option>\n              {vehicules.map((v) => (\n                <option key={v.id} value={v.id}>{v.immatriculation}</option>\n              ))}\n            </select>\n          </div>\n          <div className=\"search-group\" style={{ display: 'flex', flexDirection: 'column', gap: '5px' }}>\n            <label>Statut:</label>\n            <select \n              className=\"select-input\"\n              value={statut}\n              onChange={(e) => setStatut(e.target.value)}\n              style={{\n                padding: '8px 12px',\n                borderRadius: '4px',\n                border: '1px solid #ccc',\n                fontSize: '14px',\n                width: '160px',\n                backgroundColor: 'white'\n              }}\n              title=\"Filtrer par statut\"\n            >\n              <option value=\"\">Tous</option>\n              <option value=\"Livré\">Livré</option>\n              <option value=\"En cours\">En cours</option>\n            </select>\n          </div>\n          <div className=\"search-group\" style={{ display: 'flex', flexDirection: 'column', gap: '5px' }}>\n            <label>ID Colis:</label>\n            <input\n              type=\"text\"\n              className=\"text-input\"\n              placeholder=\"ID Colis\"\n              value={idColis}\n              onChange={(e) => setIdColis(e.target.value)}\n              style={{\n                padding: '8px 12px',\n                borderRadius: '4px',\n                border: '1px solid #ccc',\n                fontSize: '14px',\n                width: '160px'\n              }}\n              title=\"Filtrer par ID de colis\"\n            />\n          </div>\n        </div>\n        <div className=\"search-buttons\" style={{ display: 'flex', justifyContent: 'flex-start', marginTop: '15px' }}>\n          <button \n            className=\"search-button\" \n            onClick={handleSearch}\n            style={{ \n              backgroundColor: '#1976d2', \n              color: 'white', \n              padding: '10px 20px',\n              border: 'none',\n              borderRadius: '4px',\n              cursor: 'pointer',\n              fontSize: '14px',\n              fontWeight: 'bold',\n              boxShadow: '0 2px 4px rgba(0,0,0,0.1)',\n              transition: 'all 0.2s ease',\n              display: 'flex',\n              alignItems: 'center',\n              justifyContent: 'center',\n              marginRight: '10px'\n            }}\n            onMouseOver={(e) => e.currentTarget.style.backgroundColor = '#1565c0'}\n            onMouseOut={(e) => e.currentTarget.style.backgroundColor = '#1976d2'}\n          >\n            <i className=\"fas fa-search\" style={{ marginRight: '8px' }}></i> Rechercher\n          </button>\n          <button \n            className=\"reset-button\" \n            onClick={resetFilters}\n            style={{ \n              backgroundColor: '#f5f5f5', \n              color: '#333', \n              padding: '10px 20px',\n              border: '1px solid #ccc',\n              borderRadius: '4px',\n              cursor: 'pointer',\n              fontSize: '14px',\n              fontWeight: 'bold',\n              transition: 'all 0.2s ease',\n              display: 'flex',\n              alignItems: 'center',\n              justifyContent: 'center'\n            }}\n            onMouseOver={(e) => e.currentTarget.style.backgroundColor = '#e0e0e0'}\n            onMouseOut={(e) => e.currentTarget.style.backgroundColor = '#f5f5f5'}\n          >\n            <i className=\"fas fa-undo\" style={{ marginRight: '8px' }}></i> Réinitialiser\n          </button>\n        </div>\n      </div>\n      \n      <div className=\"passages-table-container\" style={{ overflowX: 'auto' }}>\n        <div className=\"results-info\">\n          <p>{filteredPassages.length} résultat(s) trouvé(s){quickSearch ? ` pour la recherche \"${quickSearch}\"` : ''}</p>\n        </div>\n        \n        <div className=\"table-container\">\n          <table className=\"data-table\">\n            <thead>\n              <tr>\n                {editMode && (\n                  <th>\n                    <input \n                      type=\"checkbox\" \n                      checked={selectedPassages.length === filteredPassages.length} \n                      onChange={(e) => {\n                        if (e.target.checked) {\n                          setSelectedPassages(filteredPassages.map(passage => passage.id));\n                        } else {\n                          setSelectedPassages([]);\n                        }\n                      }}\n                      title=\"Sélectionner/Désélectionner tous les passages\"\n                      aria-label=\"Sélectionner tous les passages\"\n                    />\n                  </th>\n                )}\n                <th>PÔLE</th>\n                <th>Site de départ</th>\n                <th>Date</th>\n                <th>Heure</th>\n                <th>Status</th>\n                <th>Site d'arrivée</th>\n                <th>Véhicule</th>\n                <th>Coursier</th>\n                <th>Commentaire</th>\n              </tr>\n            </thead>\n            <tbody>\n              {filteredPassages.map((passage) => (\n                <tr key={passage.id} className={selectedPassages.includes(passage.id) ? 'selected-row' : ''}>\n                  {editMode && (\n                    <td>\n                      <input \n                        type=\"checkbox\" \n                        checked={selectedPassages.includes(passage.id)} \n                        onChange={() => togglePassageSelection(passage.id)}\n                        title={`Sélectionner le passage ${passage.id}`}\n                        aria-label={`Sélectionner le passage ${passage.id}`}\n                      />\n                    </td>\n                  )}\n                  <td>\n                    {editMode ? (\n                      <PoleSelector\n                        value={editingPassages[passage.id]?.pole || passage.pole || ''}\n                        onChange={(value) => handleCellChange(passage.id, 'pole', value)}\n                        placeholder=\"Sélectionner un pôle\"\n                        style={{ width: '100%' }}\n                        showSearch\n                        allowClear\n                        title=\"Pôle du passage\"\n                      />\n                    ) : (\n                      getPoleNameById(passage.pole)\n                    )}\n                  </td>\n                  <td>\n                    {editMode ? (\n                      <select\n                        value={editingPassages[passage.id]?.siteDepart || passage.siteDepart}\n                        onChange={(e) => handleCellChange(passage.id, 'siteDepart', e.target.value)}\n                        className=\"inline-edit-select\"\n                        title=\"Sélectionner un site de départ\"\n                        aria-label=\"Site de départ\"\n                      >\n                        <option value=\"\">Sélectionner un site</option>\n                        {sites.map(site => (\n                          <option key={site.id} value={site.id}>{site.nom}</option>\n                        ))}\n                      </select>\n                    ) : (\n                      getSiteName(passage.siteDepart)\n                    )}\n                  </td>\n                  <td>\n                    {editMode ? (\n                      <input \n                        type=\"date\" \n                        value={formatDateForInput(convertTimestampToDate(editingPassages[passage.id]?.dateHeureDepart || passage.dateHeureDepart))}\n                        onChange={(e) => {\n                          const newDate = new Date(e.target.value);\n                          handleCellChange(passage.id, 'dateHeureDepart', Timestamp.fromDate(newDate));\n                        }}\n                        className=\"inline-edit-input\"\n                        onClick={(e) => e.stopPropagation()}\n                      />\n                    ) : (\n                      formatDateFr(convertTimestampToDate(passage.dateHeureDepart))\n                    )}\n                  </td>\n                  <td>\n                    {editMode ? (\n                      <input \n                        type=\"time\" \n                        value={convertTimestampToTime(editingPassages[passage.id]?.dateHeureDepart || passage.dateHeureDepart)}\n                        onChange={(e) => {\n                          // Préserver la date mais changer l'heure\n                          const currentDate = convertTimestampToDate(editingPassages[passage.id]?.dateHeureDepart || passage.dateHeureDepart);\n                          if (currentDate) {\n                            const [hours, minutes] = e.target.value.split(':').map(Number);\n                            currentDate.setHours(hours, minutes);\n                            handleCellChange(passage.id, 'dateHeureDepart', Timestamp.fromDate(currentDate));\n                          }\n                        }}\n                        className=\"inline-edit-input\"\n                        onClick={(e) => e.stopPropagation()}\n                      />\n                    ) : (\n                      passage.dateHeureDepart ? convertTimestampToDate(passage.dateHeureDepart)?.toLocaleTimeString('fr-FR', {\n                        hour: '2-digit',\n                        minute: '2-digit'\n                      }) : ''\n                    )}\n                  </td>\n                  <td>\n                    {editMode ? (\n                      <select\n                        value={editingPassages[passage.id]?.statut || passage.statut}\n                        onChange={(e) => handleCellChange(passage.id, 'statut', e.target.value as 'Livré' | 'En cours')}\n                        className=\"inline-edit-select\"\n                      >\n                        <option value=\"Livré\">Livré</option>\n                        <option value=\"En cours\">En cours</option>\n                      </select>\n                    ) : (\n                      <span className={passage.statut === 'Livré' ? 'livré' : 'en-cours'}>\n                        {passage.statut}\n                      </span>\n                    )}\n                  </td>\n                  <td>\n                    {editMode ? (\n                      <select\n                        value={editingPassages[passage.id]?.siteFin || passage.siteFin}\n                        onChange={(e) => handleCellChange(passage.id, 'siteFin', e.target.value)}\n                        className=\"inline-edit-select\"\n                      >\n                        <option value=\"\">Sélectionner un site</option>\n                        {sites.map(site => (\n                          <option key={site.id} value={site.nom}>\n                            {site.nom}\n                          </option>\n                        ))}\n                      </select>\n                    ) : (\n                      getSiteName(passage.siteFin)\n                    )}\n                  </td>\n                  <td>\n                    {editMode ? (\n                      <input \n                        type=\"text\" \n                        value={editingPassages[passage.id]?.coursierChargement || passage.coursierChargement || ''}\n                        onChange={(e) => handleCellChange(passage.id, 'coursierChargement', e.target.value)}\n                        className=\"inline-edit-input\"\n                      />\n                    ) : (\n                      passage.coursierChargement || '-'\n                    )}\n                  </td>\n                  <td>\n                    {editMode ? (\n                      <input \n                        type=\"text\" \n                        value={editingPassages[passage.id]?.coursierLivraison || passage.coursierLivraison || ''}\n                        onChange={(e) => handleCellChange(passage.id, 'coursierLivraison', e.target.value)}\n                        className=\"inline-edit-input\"\n                      />\n                    ) : (\n                      passage.coursierLivraison || '-'\n                    )}\n                  </td>\n                  <td>\n                    {editMode ? (\n                      <select\n                        value={editingPassages[passage.id]?.tourneeId || passage.tourneeId}\n                        onChange={(e) => handleCellChange(passage.id, 'tourneeId', e.target.value)}\n                        className=\"inline-edit-select\"\n                      >\n                        <option value=\"\">Sélectionner une tournée</option>\n                        {tournees.map(tournee => (\n                          <option key={tournee.id} value={tournee.id}>\n                            {tournee.nom}\n                          </option>\n                        ))}\n                      </select>\n                    ) : (\n                      getTourneeName(passage.tourneeId)\n                    )}\n                  </td>\n                  <td>\n                    {editMode ? (\n                      <select\n                        value={editingPassages[passage.id]?.vehiculeId || passage.vehiculeId}\n                        onChange={(e) => handleCellChange(passage.id, 'vehiculeId', e.target.value)}\n                        className=\"inline-edit-select\"\n                      >\n                        <option value=\"\">Sélectionner un véhicule</option>\n                        {vehicules.map(vehicule => (\n                          <option key={vehicule.id} value={vehicule.id}>\n                            {vehicule.immatriculation}\n                          </option>\n                        ))}\n                      </select>\n                    ) : (\n                      getVehiculeImmatriculation(passage.vehiculeId)\n                    )}\n                  </td>\n                </tr>\n              ))}\n            </tbody>\n          </table>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default Passages;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}