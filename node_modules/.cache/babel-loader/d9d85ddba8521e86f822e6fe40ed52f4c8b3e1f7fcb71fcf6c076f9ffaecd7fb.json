{"ast":null,"code":"import React,{useState}from'react';import{Box,Button,Container,Typography,Paper,Divider,Grid,FormControl,InputLabel,Select,MenuItem,FormControlLabel,Checkbox,Alert,CircularProgress,Accordion,AccordionSummary,AccordionDetails,Tooltip,IconButton}from'@mui/material';import ExpandMoreIcon from'@mui/icons-material/ExpandMore';import CloudUploadIcon from'@mui/icons-material/CloudUpload';import CloudDownloadIcon from'@mui/icons-material/CloudDownload';import HelpOutlineIcon from'@mui/icons-material/HelpOutline';import InfoIcon from'@mui/icons-material/Info';import SharePointService from'../services/SharePointService';/**\n * Composant pour la synchronisation manuelle entre Firebase et SharePoint\n * Permet l'export et l'import de données via fichiers CSV/JSON/ZIP\n */import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const SharePointSync=()=>{// États pour l'exportation\nconst[exportCollection,setExportCollection]=useState('');const[exportFormat,setExportFormat]=useState('json');const[exportLoading,setExportLoading]=useState(false);// États pour l'importation\nconst[importCollection,setImportCollection]=useState('');const[importFile,setImportFile]=useState(null);const[importOptions,setImportOptions]=useState({clearCollection:false,updateExisting:true});const[importLoading,setImportLoading]=useState(false);// États pour les messages\nconst[successMessage,setSuccessMessage]=useState('');const[errorMessage,setErrorMessage]=useState('');// Liste des collections disponibles\nconst collections=['passages','sites','tournees','vehicules'];/**\n   * Gère l'exportation d'une collection\n   */const handleExport=async()=>{try{setExportLoading(true);setSuccessMessage('');setErrorMessage('');if(!exportCollection){setErrorMessage('Veuillez sélectionner une collection à exporter.');return;}if(exportCollection==='all'){if(exportFormat==='json'){await SharePointService.downloadAllCollectionsAsJSON();}else if(exportFormat==='csv'){await SharePointService.downloadAllCollectionsAsCSV();}else if(exportFormat==='zip'){await SharePointService.generateCompleteBackup();}setSuccessMessage('Toutes les collections ont été exportées avec succès.');}else{if(exportFormat==='json'){await SharePointService.downloadCollectionAsJSON(exportCollection);}else if(exportFormat==='csv'){await SharePointService.downloadCollectionAsCSV(exportCollection);}setSuccessMessage(`La collection ${exportCollection} a été exportée avec succès.`);}}catch(error){console.error('Erreur lors de l\\'exportation:',error);setErrorMessage(`Erreur lors de l'exportation: ${error instanceof Error?error.message:'Erreur inconnue'}`);}finally{setExportLoading(false);}};/**\n   * Gère la sélection d'un fichier à importer\n   */const handleFileChange=event=>{if(event.target.files&&event.target.files.length>0){setImportFile(event.target.files[0]);}};/**\n   * Gère l'importation d'un fichier\n   */const handleImport=async()=>{try{var _importFile$name$spli;setImportLoading(true);setSuccessMessage('');setErrorMessage('');if(!importFile){setErrorMessage('Veuillez sélectionner un fichier à importer.');return;}if(!importCollection&&importFile.name.endsWith('.zip')){// Pour les fichiers ZIP, la collection n'est pas nécessaire\n}else if(!importCollection){setErrorMessage('Veuillez sélectionner une collection cible.');return;}// Vérifier le type de fichier\nconst fileExtension=(_importFile$name$spli=importFile.name.split('.').pop())===null||_importFile$name$spli===void 0?void 0:_importFile$name$spli.toLowerCase();if(!['zip','json','csv','txt'].includes(fileExtension||'')){setErrorMessage(`Format de fichier non pris en charge: ${fileExtension}. Veuillez utiliser un fichier .json, .csv, .txt ou .zip.`);return;}try{let count=0;if(importFile.name.endsWith('.zip')){const fileContent=await importFile.arrayBuffer();const results=await SharePointService.importFromZip(fileContent,importOptions);const totalImported=Object.values(results).reduce((sum,count)=>sum+count,0);setSuccessMessage(`Importation réussie: ${totalImported} documents importés dans ${Object.keys(results).length} collections.`);}else if(importFile.name.endsWith('.json')){let jsonContent;try{const fileText=await importFile.text();jsonContent=JSON.parse(fileText);}catch(parseError){console.error('Erreur lors de l\\'analyse du fichier JSON:',parseError);setErrorMessage(`Le fichier JSON est invalide et ne peut pas être analysé. Erreur: ${parseError instanceof Error?parseError.message:'Format JSON incorrect'}`);return;}if(!Array.isArray(jsonContent)){setErrorMessage('Le fichier JSON doit contenir un tableau d\\'objets.');return;}count=await SharePointService.importJSONToCollection(importCollection,jsonContent,importOptions);setSuccessMessage(`Importation réussie: ${count} documents importés dans la collection ${importCollection}.`);}else if(importFile.name.endsWith('.csv')||importFile.name.endsWith('.txt')){let csvContent;try{csvContent=await importFile.text();// Vérifier que le contenu CSV/TXT est valide\nif(!csvContent||csvContent.trim()===''){setErrorMessage('Le fichier est vide.');return;}// Vérifier que le fichier a au moins une ligne d'en-tête\nconst lines=csvContent.split('\\n');if(lines.length<1||lines[0].trim()===''){setErrorMessage('Le fichier ne contient pas d\\'en-têtes valides.');return;}console.log(`Fichier ${importFile.name.endsWith('.txt')?'TXT':'CSV'} chargé: ${importFile.name}, taille: ${importFile.size} octets, première ligne: ${lines[0].substring(0,100)}...`);}catch(readError){console.error(`Erreur lors de la lecture du fichier ${importFile.name.endsWith('.txt')?'TXT':'CSV'}:`,readError);setErrorMessage(`Impossible de lire le fichier. Erreur: ${readError instanceof Error?readError.message:'Erreur de lecture'}`);return;}if(importCollection==='sites'){// Utiliser la fonction spécifique pour les sites\ncount=await SharePointService.importSitesFromCSV(csvContent,{...importOptions,isTxtFile:importFile.name.endsWith('.txt'),fileName:importFile.name});}else{// Utiliser la fonction générique pour les autres collections\ncount=await SharePointService.importCSVToCollection(importCollection,csvContent,importOptions);}setSuccessMessage(`Importation réussie: ${count} documents importés dans la collection ${importCollection}.`);}else{setErrorMessage('Format de fichier non pris en charge. Veuillez utiliser un fichier .json, .csv, .txt ou .zip.');}}catch(importError){console.error('Erreur détaillée lors de l\\'importation:',importError);// Traitement spécifique pour l'erreur \"n.indexOf is not a function\"\nif(importError instanceof Error&&importError.message.includes('indexOf is not a function')){setErrorMessage(`Erreur de format: Le fichier CSV contient probablement un format non standard ou des caractères spéciaux. \n            Veuillez vérifier que votre fichier est correctement formaté avec des séparateurs standards (virgules, points-virgules ou tabulations).\n            Conseil: Ouvrez le fichier dans un éditeur de texte pour vérifier sa structure.`);}else{setErrorMessage(`Erreur lors de l'importation: ${importError instanceof Error?importError.message:'Erreur inconnue'}`);}}}catch(error){console.error('Erreur générale lors de l\\'importation:',error);setErrorMessage(`Erreur lors de l'importation: ${error instanceof Error?error.message:'Erreur inconnue'}`);}finally{setImportLoading(false);}};return/*#__PURE__*/_jsxs(Container,{maxWidth:\"lg\",sx:{mt:4,mb:4},children:[/*#__PURE__*/_jsxs(Typography,{variant:\"h4\",component:\"h1\",gutterBottom:true,children:[\"Synchronisation SharePoint\",/*#__PURE__*/_jsx(Tooltip,{title:\"Cette fonctionnalit\\xE9 permet d'exporter et d'importer des donn\\xE9es entre Firebase et SharePoint via des fichiers interm\\xE9diaires.\",children:/*#__PURE__*/_jsx(IconButton,{size:\"small\",sx:{ml:1},children:/*#__PURE__*/_jsx(HelpOutlineIcon,{})})})]}),/*#__PURE__*/_jsx(Alert,{severity:\"info\",sx:{mb:3},children:/*#__PURE__*/_jsx(Typography,{variant:\"body1\",children:\"Cette interface permet de synchroniser manuellement les donn\\xE9es entre Firebase et SharePoint. En raison des limitations d'authentification, la synchronisation se fait via des fichiers interm\\xE9diaires.\"})}),successMessage&&/*#__PURE__*/_jsx(Alert,{severity:\"success\",sx:{mb:2},children:successMessage}),errorMessage&&/*#__PURE__*/_jsx(Alert,{severity:\"error\",sx:{mb:2},children:errorMessage}),/*#__PURE__*/_jsxs(Grid,{container:true,spacing:3,children:[/*#__PURE__*/_jsx(Grid,{item:true,xs:12,md:6,children:/*#__PURE__*/_jsxs(Paper,{sx:{p:3,height:'100%'},children:[/*#__PURE__*/_jsxs(Typography,{variant:\"h5\",component:\"h2\",gutterBottom:true,children:[\"Exporter des donn\\xE9es\",/*#__PURE__*/_jsx(Tooltip,{title:\"Exporter les donn\\xE9es de Firebase vers un fichier que vous pourrez ensuite importer dans SharePoint.\",children:/*#__PURE__*/_jsx(IconButton,{size:\"small\",sx:{ml:1},children:/*#__PURE__*/_jsx(InfoIcon,{})})})]}),/*#__PURE__*/_jsx(Divider,{sx:{my:2}}),/*#__PURE__*/_jsxs(FormControl,{fullWidth:true,margin:\"normal\",children:[/*#__PURE__*/_jsx(InputLabel,{children:\"Collection \\xE0 exporter\"}),/*#__PURE__*/_jsxs(Select,{value:exportCollection,onChange:e=>setExportCollection(e.target.value),label:\"Collection \\xE0 exporter\",children:[/*#__PURE__*/_jsx(MenuItem,{value:\"\",children:\"S\\xE9lectionner une collection\"}),collections.map(collection=>/*#__PURE__*/_jsx(MenuItem,{value:collection,children:collection},collection)),/*#__PURE__*/_jsx(MenuItem,{value:\"all\",children:\"Toutes les collections\"})]})]}),/*#__PURE__*/_jsxs(FormControl,{fullWidth:true,margin:\"normal\",children:[/*#__PURE__*/_jsx(InputLabel,{children:\"Format d'exportation\"}),/*#__PURE__*/_jsxs(Select,{value:exportFormat,onChange:e=>setExportFormat(e.target.value),label:\"Format d'exportation\",children:[/*#__PURE__*/_jsx(MenuItem,{value:\"json\",children:\"JSON\"}),/*#__PURE__*/_jsx(MenuItem,{value:\"csv\",children:\"CSV\"}),exportCollection==='all'&&/*#__PURE__*/_jsx(MenuItem,{value:\"zip\",children:\"ZIP (toutes les collections en JSON)\"})]})]}),/*#__PURE__*/_jsx(Button,{variant:\"contained\",color:\"primary\",fullWidth:true,startIcon:exportLoading?/*#__PURE__*/_jsx(CircularProgress,{size:24,color:\"inherit\"}):/*#__PURE__*/_jsx(CloudDownloadIcon,{}),onClick:handleExport,disabled:exportLoading||!exportCollection,sx:{mt:2},children:exportLoading?'Exportation en cours...':'Exporter'}),/*#__PURE__*/_jsxs(Accordion,{sx:{mt:2},children:[/*#__PURE__*/_jsx(AccordionSummary,{expandIcon:/*#__PURE__*/_jsx(ExpandMoreIcon,{}),children:/*#__PURE__*/_jsx(Typography,{children:\"Instructions pour SharePoint\"})}),/*#__PURE__*/_jsx(AccordionDetails,{children:/*#__PURE__*/_jsxs(Typography,{variant:\"body2\",children:[\"1. Exportez les donn\\xE9es en utilisant le bouton ci-dessus.\",/*#__PURE__*/_jsx(\"br\",{}),\"2. Connectez-vous \\xE0 votre site SharePoint.\",/*#__PURE__*/_jsx(\"br\",{}),\"3. Acc\\xE9dez \\xE0 la biblioth\\xE8que de documents o\\xF9 vous souhaitez stocker les donn\\xE9es.\",/*#__PURE__*/_jsx(\"br\",{}),\"4. Cliquez sur \\\"Charger\\\" et s\\xE9lectionnez le fichier export\\xE9.\",/*#__PURE__*/_jsx(\"br\",{}),\"5. V\\xE9rifiez que le fichier a \\xE9t\\xE9 correctement charg\\xE9.\"]})})]})]})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,md:6,children:/*#__PURE__*/_jsxs(Paper,{sx:{p:3,height:'100%'},children:[/*#__PURE__*/_jsxs(Typography,{variant:\"h5\",component:\"h2\",gutterBottom:true,children:[\"Importer des donn\\xE9es\",/*#__PURE__*/_jsx(Tooltip,{title:\"Importer des donn\\xE9es depuis un fichier SharePoint vers Firebase.\",children:/*#__PURE__*/_jsx(IconButton,{size:\"small\",sx:{ml:1},children:/*#__PURE__*/_jsx(InfoIcon,{})})})]}),/*#__PURE__*/_jsx(Divider,{sx:{my:2}}),/*#__PURE__*/_jsxs(FormControl,{fullWidth:true,margin:\"normal\",children:[/*#__PURE__*/_jsx(InputLabel,{children:\"Collection cible\"}),/*#__PURE__*/_jsxs(Select,{value:importCollection,onChange:e=>setImportCollection(e.target.value),label:\"Collection cible\",disabled:importFile===null||importFile===void 0?void 0:importFile.name.endsWith('.zip'),children:[/*#__PURE__*/_jsx(MenuItem,{value:\"\",children:\"S\\xE9lectionner une collection\"}),collections.map(collection=>/*#__PURE__*/_jsx(MenuItem,{value:collection,children:collection},collection))]}),(importFile===null||importFile===void 0?void 0:importFile.name.endsWith('.zip'))&&/*#__PURE__*/_jsx(Typography,{variant:\"caption\",color:\"text.secondary\",sx:{mt:1},children:\"Pour les fichiers ZIP, la collection est d\\xE9termin\\xE9e automatiquement.\"})]}),/*#__PURE__*/_jsxs(Box,{sx:{mt:2},children:[/*#__PURE__*/_jsxs(Button,{variant:\"outlined\",component:\"label\",fullWidth:true,startIcon:/*#__PURE__*/_jsx(CloudUploadIcon,{}),children:[\"S\\xE9lectionner un fichier\",/*#__PURE__*/_jsx(\"input\",{type:\"file\",hidden:true,accept:\".json,.csv,.zip,.txt\",onChange:handleFileChange})]}),importFile&&/*#__PURE__*/_jsxs(Typography,{variant:\"body2\",sx:{mt:1},children:[\"Fichier s\\xE9lectionn\\xE9: \",importFile.name]}),/*#__PURE__*/_jsx(Typography,{variant:\"caption\",color:\"text.secondary\",sx:{display:'block',mt:1},children:\"Formats support\\xE9s: JSON, CSV, ZIP, et TXT (pour les sites)\"})]}),/*#__PURE__*/_jsxs(Box,{sx:{mt:2},children:[/*#__PURE__*/_jsx(FormControlLabel,{control:/*#__PURE__*/_jsx(Checkbox,{checked:importOptions.clearCollection,onChange:e=>setImportOptions({...importOptions,clearCollection:e.target.checked})}),label:\"Vider la collection avant l'importation\"}),/*#__PURE__*/_jsx(FormControlLabel,{control:/*#__PURE__*/_jsx(Checkbox,{checked:importOptions.updateExisting,onChange:e=>setImportOptions({...importOptions,updateExisting:e.target.checked})}),label:\"Mettre \\xE0 jour les documents existants\"})]}),/*#__PURE__*/_jsx(Button,{variant:\"contained\",color:\"secondary\",fullWidth:true,startIcon:importLoading?/*#__PURE__*/_jsx(CircularProgress,{size:24,color:\"inherit\"}):/*#__PURE__*/_jsx(CloudUploadIcon,{}),onClick:handleImport,disabled:importLoading||!importFile||!importCollection&&!(importFile!==null&&importFile!==void 0&&importFile.name.endsWith('.zip')),sx:{mt:2},children:importLoading?'Importation en cours...':'Importer'}),/*#__PURE__*/_jsxs(Accordion,{sx:{mt:2},children:[/*#__PURE__*/_jsx(AccordionSummary,{expandIcon:/*#__PURE__*/_jsx(ExpandMoreIcon,{}),children:/*#__PURE__*/_jsx(Typography,{children:\"Instructions pour SharePoint\"})}),/*#__PURE__*/_jsx(AccordionDetails,{children:/*#__PURE__*/_jsxs(Typography,{variant:\"body2\",children:[\"1. Connectez-vous \\xE0 votre site SharePoint.\",/*#__PURE__*/_jsx(\"br\",{}),\"2. Acc\\xE9dez \\xE0 la biblioth\\xE8que de documents o\\xF9 sont stock\\xE9es les donn\\xE9es.\",/*#__PURE__*/_jsx(\"br\",{}),\"3. T\\xE9l\\xE9chargez le fichier que vous souhaitez importer.\",/*#__PURE__*/_jsx(\"br\",{}),\"4. Revenez \\xE0 cette page et s\\xE9lectionnez le fichier t\\xE9l\\xE9charg\\xE9.\",/*#__PURE__*/_jsx(\"br\",{}),\"5. Choisissez la collection cible et les options d'importation.\",/*#__PURE__*/_jsx(\"br\",{}),\"6. Cliquez sur \\\"Importer\\\" pour lancer l'importation.\"]})})]}),/*#__PURE__*/_jsxs(Accordion,{sx:{mt:2},children:[/*#__PURE__*/_jsx(AccordionSummary,{expandIcon:/*#__PURE__*/_jsx(ExpandMoreIcon,{}),children:/*#__PURE__*/_jsx(Typography,{children:\"Format CSV/TXT attendu\"})}),/*#__PURE__*/_jsxs(AccordionDetails,{children:[/*#__PURE__*/_jsxs(Typography,{variant:\"body2\",gutterBottom:true,children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Pour l'importation des sites\"}),\", votre fichier CSV ou TXT doit contenir les colonnes suivantes (s\\xE9par\\xE9es par des virgules, des points-virgules ou des tabulations) :\"]}),/*#__PURE__*/_jsx(Typography,{variant:\"body2\",component:\"div\",sx:{mt:1,mb:2},children:/*#__PURE__*/_jsx(\"code\",{style:{display:'block',whiteSpace:'pre-wrap',backgroundColor:'#f5f5f5',padding:'8px',borderRadius:'4px',fontSize:'0.85rem'},children:\"P\\xD4LE,NOM,TYPE,ADRESSE,VILLE,CODE POSTAL,TELEPHONE,EMAIL,CODE-BARRE,TOURN\\xC9ES,CODE PORTE,COORDONN\\xC9ES,STATUT\"})}),/*#__PURE__*/_jsx(Typography,{variant:\"body2\",gutterBottom:true,children:/*#__PURE__*/_jsx(\"strong\",{children:\"Exemple de ligne valide :\"})}),/*#__PURE__*/_jsx(Typography,{variant:\"body2\",component:\"div\",sx:{mt:1,mb:2},children:/*#__PURE__*/_jsx(\"code\",{style:{display:'block',whiteSpace:'pre-wrap',backgroundColor:'#f5f5f5',padding:'8px',borderRadius:'4px',fontSize:'0.85rem'},children:\"P\\xF4le Est,Laboratoire Central,Laboratoire,15 Rue des Sciences,Paris,75001,0123456789,lab@example.com,LAB001,\\\"tournee1,tournee2\\\",CODE123,,ACTIF\"})}),/*#__PURE__*/_jsx(Typography,{variant:\"body2\",gutterBottom:true,children:/*#__PURE__*/_jsx(\"strong\",{children:\"Notes importantes :\"})}),/*#__PURE__*/_jsxs(\"ul\",{style:{fontSize:'0.875rem',paddingLeft:'20px'},children:[/*#__PURE__*/_jsx(\"li\",{children:\"Assurez-vous que chaque site est sur une ligne distincte\"}),/*#__PURE__*/_jsx(\"li\",{children:\"Les tourn\\xE9es peuvent \\xEAtre s\\xE9par\\xE9es par des virgules \\xE0 l'int\\xE9rieur de guillemets\"}),/*#__PURE__*/_jsx(\"li\",{children:\"Si votre fichier provient d'Excel, utilisez \\\"Enregistrer sous\\\" et choisissez le format CSV ou TXT\"}),/*#__PURE__*/_jsx(\"li\",{children:\"V\\xE9rifiez que votre fichier utilise un s\\xE9parateur standard (virgule, point-virgule ou tabulation)\"}),/*#__PURE__*/_jsx(\"li\",{children:\"Si vous avez des probl\\xE8mes, essayez d'ouvrir votre fichier dans un \\xE9diteur de texte pour v\\xE9rifier sa structure\"})]}),/*#__PURE__*/_jsxs(Typography,{variant:\"body2\",sx:{mt:2},color:\"primary\",children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Recommandation pour les fichiers TXT :\"}),\" Pour une meilleure compatibilit\\xE9, exportez depuis Excel en choisissant \\\"Texte (s\\xE9parateur : tabulation) (*.txt)\\\". Les fichiers TXT utilisent par d\\xE9faut la tabulation comme s\\xE9parateur, ce qui \\xE9vite les probl\\xE8mes avec les virgules ou points-virgules dans les donn\\xE9es.\"]})]})]}),/*#__PURE__*/_jsxs(Accordion,{sx:{mt:2},children:[/*#__PURE__*/_jsx(AccordionSummary,{expandIcon:/*#__PURE__*/_jsx(ExpandMoreIcon,{}),children:/*#__PURE__*/_jsx(Typography,{children:\"R\\xE9solution des probl\\xE8mes d'importation\"})}),/*#__PURE__*/_jsxs(AccordionDetails,{children:[/*#__PURE__*/_jsx(Typography,{variant:\"body2\",gutterBottom:true,children:/*#__PURE__*/_jsx(\"strong\",{children:\"Erreur \\\"n.indexOf is not a function\\\"\"})}),/*#__PURE__*/_jsx(Typography,{variant:\"body2\",paragraph:true,children:\"Cette erreur se produit g\\xE9n\\xE9ralement lorsque le format du fichier CSV n'est pas standard. Voici comment la r\\xE9soudre :\"}),/*#__PURE__*/_jsxs(\"ol\",{style:{fontSize:'0.875rem',paddingLeft:'20px'},children:[/*#__PURE__*/_jsxs(\"li\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"V\\xE9rifiez le format du fichier\"}),\" : Ouvrez votre fichier CSV ou TXT dans un \\xE9diteur de texte (comme Notepad) et v\\xE9rifiez que :\",/*#__PURE__*/_jsxs(\"ul\",{style:{marginTop:'4px'},children:[/*#__PURE__*/_jsx(\"li\",{children:\"La premi\\xE8re ligne contient bien les en-t\\xEAtes des colonnes\"}),/*#__PURE__*/_jsx(\"li\",{children:\"Les colonnes sont s\\xE9par\\xE9es par des virgules, des points-virgules ou des tabulations\"}),/*#__PURE__*/_jsx(\"li\",{children:\"Il n'y a pas de caract\\xE8res sp\\xE9ciaux ou de formatage particulier\"})]})]}),/*#__PURE__*/_jsxs(\"li\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Depuis Excel\"}),\" : Si vous exportez depuis Excel, suivez ces \\xE9tapes :\",/*#__PURE__*/_jsxs(\"ul\",{style:{marginTop:'4px'},children:[/*#__PURE__*/_jsx(\"li\",{children:\"S\\xE9lectionnez \\\"Fichier\\\" > \\\"Enregistrer sous\\\"\"}),/*#__PURE__*/_jsx(\"li\",{children:\"Choisissez \\\"CSV (s\\xE9parateur : point-virgule) (*.csv)\\\" ou \\\"Texte (s\\xE9parateur : tabulation) (*.txt)\\\"\"}),/*#__PURE__*/_jsx(\"li\",{children:\"Cliquez sur \\\"Enregistrer\\\"\"}),/*#__PURE__*/_jsx(\"li\",{children:\"Ignorez les avertissements sur les fonctionnalit\\xE9s incompatibles\"})]})]}),/*#__PURE__*/_jsxs(\"li\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Cr\\xE9ez un nouveau fichier\"}),\" : Si les solutions ci-dessus ne fonctionnent pas, cr\\xE9ez un nouveau fichier CSV ou TXT :\",/*#__PURE__*/_jsxs(\"ul\",{style:{marginTop:'4px'},children:[/*#__PURE__*/_jsx(\"li\",{children:\"Ouvrez un \\xE9diteur de texte vide (comme Notepad)\"}),/*#__PURE__*/_jsx(\"li\",{children:\"Copiez-collez les en-t\\xEAtes sur la premi\\xE8re ligne, s\\xE9par\\xE9s par des virgules ou des tabulations\"}),/*#__PURE__*/_jsx(\"li\",{children:\"Ajoutez vos donn\\xE9es sur les lignes suivantes, en respectant le m\\xEAme format\"}),/*#__PURE__*/_jsx(\"li\",{children:\"Enregistrez le fichier avec l'extension .csv ou .txt\"})]})]})]}),/*#__PURE__*/_jsxs(Typography,{variant:\"body2\",sx:{mt:2},paragraph:true,children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Exemple de fichier CSV/TXT valide\"}),\" (ouvert dans un \\xE9diteur de texte) :\"]}),/*#__PURE__*/_jsx(Typography,{variant:\"body2\",component:\"div\",sx:{mt:1,mb:2},children:/*#__PURE__*/_jsxs(\"code\",{style:{display:'block',whiteSpace:'pre-wrap',backgroundColor:'#f5f5f5',padding:'8px',borderRadius:'4px',fontSize:'0.85rem'},children:[\"P\\xD4LE,NOM,TYPE,ADRESSE,VILLE,CODE POSTAL,TELEPHONE,EMAIL,CODE-BARRE,TOURN\\xC9ES,CODE PORTE,COORDONN\\xC9ES,STATUT\",/*#__PURE__*/_jsx(\"br\",{}),\"P\\xF4le Est,Laboratoire Central,Laboratoire,15 Rue des Sciences,Paris,75001,0123456789,lab@example.com,LAB001,\\\"tournee1,tournee2\\\",CODE123,,ACTIF\",/*#__PURE__*/_jsx(\"br\",{}),\"P\\xF4le Ouest,Entrep\\xF4t Principal,Entrep\\xF4t,25 Avenue du Commerce,Lyon,69002,0987654321,entrepot@example.com,ENT002,tournee3,CODE456,,ACTIF\"]})}),/*#__PURE__*/_jsx(Typography,{variant:\"body2\",gutterBottom:true,children:/*#__PURE__*/_jsx(\"strong\",{children:\"Erreur \\\"Aucun document valide n'a pu \\xEAtre extrait du fichier\\\"\"})}),/*#__PURE__*/_jsx(Typography,{variant:\"body2\",paragraph:true,children:\"Cette erreur peut \\xEAtre caus\\xE9e par des probl\\xE8mes d'encodage, particuli\\xE8rement avec les caract\\xE8res accentu\\xE9s. Voici comment la r\\xE9soudre :\"}),/*#__PURE__*/_jsxs(\"ol\",{style:{fontSize:'0.875rem',paddingLeft:'20px'},children:[/*#__PURE__*/_jsxs(\"li\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"V\\xE9rifiez l'encodage du fichier\"}),\" : Assurez-vous que votre fichier est enregistr\\xE9 en UTF-8 :\",/*#__PURE__*/_jsxs(\"ul\",{style:{marginTop:'4px'},children:[/*#__PURE__*/_jsx(\"li\",{children:\"Dans Excel, utilisez \\\"Enregistrer sous\\\" et s\\xE9lectionnez \\\"CSV UTF-8 (d\\xE9limit\\xE9 par des virgules) (*.csv)\\\"\"}),/*#__PURE__*/_jsx(\"li\",{children:\"Dans Notepad, utilisez \\\"Enregistrer sous\\\" et s\\xE9lectionnez \\\"UTF-8\\\" dans le menu d\\xE9roulant \\\"Encodage\\\"\"})]})]}),/*#__PURE__*/_jsxs(\"li\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"V\\xE9rifiez les en-t\\xEAtes\"}),\" : Assurez-vous que vos en-t\\xEAtes correspondent aux noms attendus :\",/*#__PURE__*/_jsxs(\"ul\",{style:{marginTop:'4px'},children:[/*#__PURE__*/_jsx(\"li\",{children:\"Les en-t\\xEAtes doivent contenir au moins \\\"NOM\\\" ou \\\"CODE-BARRE\\\" pour identifier chaque site\"}),/*#__PURE__*/_jsx(\"li\",{children:\"V\\xE9rifiez que les accents sont correctement encod\\xE9s (ex: \\\"P\\xD4LE\\\" et non \\\"PLE\\\")\"})]})]}),/*#__PURE__*/_jsxs(\"li\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Utilisez un format TXT avec tabulations\"}),\" : Les fichiers TXT avec tabulations sont souvent plus fiables :\",/*#__PURE__*/_jsxs(\"ul\",{style:{marginTop:'4px'},children:[/*#__PURE__*/_jsx(\"li\",{children:\"Dans Excel, utilisez \\\"Enregistrer sous\\\" et s\\xE9lectionnez \\\"Texte (s\\xE9parateur : tabulation) (*.txt)\\\"\"}),/*#__PURE__*/_jsx(\"li\",{children:\"Cela \\xE9vite les probl\\xE8mes avec les virgules ou points-virgules dans les donn\\xE9es\"})]})]})]})]})]})]})})]})]});};export default SharePointSync;","map":{"version":3,"names":["React","useState","Box","Button","Container","Typography","Paper","Divider","Grid","FormControl","InputLabel","Select","MenuItem","FormControlLabel","Checkbox","Alert","CircularProgress","Accordion","AccordionSummary","AccordionDetails","Tooltip","IconButton","ExpandMoreIcon","CloudUploadIcon","CloudDownloadIcon","HelpOutlineIcon","InfoIcon","SharePointService","jsx","_jsx","jsxs","_jsxs","SharePointSync","exportCollection","setExportCollection","exportFormat","setExportFormat","exportLoading","setExportLoading","importCollection","setImportCollection","importFile","setImportFile","importOptions","setImportOptions","clearCollection","updateExisting","importLoading","setImportLoading","successMessage","setSuccessMessage","errorMessage","setErrorMessage","collections","handleExport","downloadAllCollectionsAsJSON","downloadAllCollectionsAsCSV","generateCompleteBackup","downloadCollectionAsJSON","downloadCollectionAsCSV","error","console","Error","message","handleFileChange","event","target","files","length","handleImport","_importFile$name$spli","name","endsWith","fileExtension","split","pop","toLowerCase","includes","count","fileContent","arrayBuffer","results","importFromZip","totalImported","Object","values","reduce","sum","keys","jsonContent","fileText","text","JSON","parse","parseError","Array","isArray","importJSONToCollection","csvContent","trim","lines","log","size","substring","readError","importSitesFromCSV","isTxtFile","fileName","importCSVToCollection","importError","maxWidth","sx","mt","mb","children","variant","component","gutterBottom","title","ml","severity","container","spacing","item","xs","md","p","height","my","fullWidth","margin","value","onChange","e","label","map","collection","color","startIcon","onClick","disabled","expandIcon","type","hidden","accept","display","control","checked","style","whiteSpace","backgroundColor","padding","borderRadius","fontSize","paddingLeft","paragraph","marginTop"],"sources":["C:/Users/LS_110/Documents/GitHub/inovie-SCAN-web-main/src/components/SharePointSync.tsx"],"sourcesContent":["import React, { useState } from 'react';\nimport { \n  Box, \n  Button, \n  Container, \n  Typography, \n  Paper, \n  Divider, \n  Grid, \n  FormControl, \n  InputLabel, \n  Select, \n  MenuItem, \n  FormControlLabel, \n  Checkbox, \n  Alert, \n  CircularProgress,\n  Accordion,\n  AccordionSummary,\n  AccordionDetails,\n  Tooltip,\n  IconButton\n} from '@mui/material';\nimport ExpandMoreIcon from '@mui/icons-material/ExpandMore';\nimport CloudUploadIcon from '@mui/icons-material/CloudUpload';\nimport CloudDownloadIcon from '@mui/icons-material/CloudDownload';\nimport HelpOutlineIcon from '@mui/icons-material/HelpOutline';\nimport InfoIcon from '@mui/icons-material/Info';\nimport SharePointService from '../services/SharePointService';\n\n/**\n * Composant pour la synchronisation manuelle entre Firebase et SharePoint\n * Permet l'export et l'import de données via fichiers CSV/JSON/ZIP\n */\nconst SharePointSync: React.FC = () => {\n  // États pour l'exportation\n  const [exportCollection, setExportCollection] = useState<string>('');\n  const [exportFormat, setExportFormat] = useState<string>('json');\n  const [exportLoading, setExportLoading] = useState<boolean>(false);\n  \n  // États pour l'importation\n  const [importCollection, setImportCollection] = useState<string>('');\n  const [importFile, setImportFile] = useState<File | null>(null);\n  const [importOptions, setImportOptions] = useState({\n    clearCollection: false,\n    updateExisting: true\n  });\n  const [importLoading, setImportLoading] = useState<boolean>(false);\n  \n  // États pour les messages\n  const [successMessage, setSuccessMessage] = useState<string>('');\n  const [errorMessage, setErrorMessage] = useState<string>('');\n  \n  // Liste des collections disponibles\n  const collections = ['passages', 'sites', 'tournees', 'vehicules'];\n  \n  /**\n   * Gère l'exportation d'une collection\n   */\n  const handleExport = async () => {\n    try {\n      setExportLoading(true);\n      setSuccessMessage('');\n      setErrorMessage('');\n      \n      if (!exportCollection) {\n        setErrorMessage('Veuillez sélectionner une collection à exporter.');\n        return;\n      }\n      \n      if (exportCollection === 'all') {\n        if (exportFormat === 'json') {\n          await SharePointService.downloadAllCollectionsAsJSON();\n        } else if (exportFormat === 'csv') {\n          await SharePointService.downloadAllCollectionsAsCSV();\n        } else if (exportFormat === 'zip') {\n          await SharePointService.generateCompleteBackup();\n        }\n        \n        setSuccessMessage('Toutes les collections ont été exportées avec succès.');\n      } else {\n        if (exportFormat === 'json') {\n          await SharePointService.downloadCollectionAsJSON(exportCollection);\n        } else if (exportFormat === 'csv') {\n          await SharePointService.downloadCollectionAsCSV(exportCollection);\n        }\n        \n        setSuccessMessage(`La collection ${exportCollection} a été exportée avec succès.`);\n      }\n    } catch (error) {\n      console.error('Erreur lors de l\\'exportation:', error);\n      setErrorMessage(`Erreur lors de l'exportation: ${error instanceof Error ? error.message : 'Erreur inconnue'}`);\n    } finally {\n      setExportLoading(false);\n    }\n  };\n  \n  /**\n   * Gère la sélection d'un fichier à importer\n   */\n  const handleFileChange = (event: React.ChangeEvent<HTMLInputElement>) => {\n    if (event.target.files && event.target.files.length > 0) {\n      setImportFile(event.target.files[0]);\n    }\n  };\n  \n  /**\n   * Gère l'importation d'un fichier\n   */\n  const handleImport = async () => {\n    try {\n      setImportLoading(true);\n      setSuccessMessage('');\n      setErrorMessage('');\n      \n      if (!importFile) {\n        setErrorMessage('Veuillez sélectionner un fichier à importer.');\n        return;\n      }\n      \n      if (!importCollection && importFile.name.endsWith('.zip')) {\n        // Pour les fichiers ZIP, la collection n'est pas nécessaire\n      } else if (!importCollection) {\n        setErrorMessage('Veuillez sélectionner une collection cible.');\n        return;\n      }\n      \n      // Vérifier le type de fichier\n      const fileExtension = importFile.name.split('.').pop()?.toLowerCase();\n      if (!['zip', 'json', 'csv', 'txt'].includes(fileExtension || '')) {\n        setErrorMessage(`Format de fichier non pris en charge: ${fileExtension}. Veuillez utiliser un fichier .json, .csv, .txt ou .zip.`);\n        return;\n      }\n      \n      try {\n        let count = 0;\n        \n        if (importFile.name.endsWith('.zip')) {\n          const fileContent = await importFile.arrayBuffer();\n          const results = await SharePointService.importFromZip(fileContent, importOptions);\n          \n          const totalImported = Object.values(results).reduce((sum, count) => sum + count, 0);\n          setSuccessMessage(`Importation réussie: ${totalImported} documents importés dans ${Object.keys(results).length} collections.`);\n        } else if (importFile.name.endsWith('.json')) {\n          let jsonContent;\n          try {\n            const fileText = await importFile.text();\n            jsonContent = JSON.parse(fileText);\n          } catch (parseError) {\n            console.error('Erreur lors de l\\'analyse du fichier JSON:', parseError);\n            setErrorMessage(`Le fichier JSON est invalide et ne peut pas être analysé. Erreur: ${parseError instanceof Error ? parseError.message : 'Format JSON incorrect'}`);\n            return;\n          }\n          \n          if (!Array.isArray(jsonContent)) {\n            setErrorMessage('Le fichier JSON doit contenir un tableau d\\'objets.');\n            return;\n          }\n          \n          count = await SharePointService.importJSONToCollection(\n            importCollection,\n            jsonContent,\n            importOptions\n          );\n          \n          setSuccessMessage(`Importation réussie: ${count} documents importés dans la collection ${importCollection}.`);\n        } else if (importFile.name.endsWith('.csv') || importFile.name.endsWith('.txt')) {\n          let csvContent;\n          try {\n            csvContent = await importFile.text();\n            \n            // Vérifier que le contenu CSV/TXT est valide\n            if (!csvContent || csvContent.trim() === '') {\n              setErrorMessage('Le fichier est vide.');\n              return;\n            }\n            \n            // Vérifier que le fichier a au moins une ligne d'en-tête\n            const lines = csvContent.split('\\n');\n            if (lines.length < 1 || lines[0].trim() === '') {\n              setErrorMessage('Le fichier ne contient pas d\\'en-têtes valides.');\n              return;\n            }\n            \n            console.log(`Fichier ${importFile.name.endsWith('.txt') ? 'TXT' : 'CSV'} chargé: ${importFile.name}, taille: ${importFile.size} octets, première ligne: ${lines[0].substring(0, 100)}...`);\n          } catch (readError) {\n            console.error(`Erreur lors de la lecture du fichier ${importFile.name.endsWith('.txt') ? 'TXT' : 'CSV'}:`, readError);\n            setErrorMessage(`Impossible de lire le fichier. Erreur: ${readError instanceof Error ? readError.message : 'Erreur de lecture'}`);\n            return;\n          }\n          \n          if (importCollection === 'sites') {\n            // Utiliser la fonction spécifique pour les sites\n            count = await SharePointService.importSitesFromCSV(\n              csvContent,\n              {\n                ...importOptions,\n                isTxtFile: importFile.name.endsWith('.txt'),\n                fileName: importFile.name\n              }\n            );\n          } else {\n            // Utiliser la fonction générique pour les autres collections\n            count = await SharePointService.importCSVToCollection(\n              importCollection,\n              csvContent,\n              importOptions\n            );\n          }\n          \n          setSuccessMessage(`Importation réussie: ${count} documents importés dans la collection ${importCollection}.`);\n        } else {\n          setErrorMessage('Format de fichier non pris en charge. Veuillez utiliser un fichier .json, .csv, .txt ou .zip.');\n        }\n      } catch (importError) {\n        console.error('Erreur détaillée lors de l\\'importation:', importError);\n        \n        // Traitement spécifique pour l'erreur \"n.indexOf is not a function\"\n        if (importError instanceof Error && importError.message.includes('indexOf is not a function')) {\n          setErrorMessage(`Erreur de format: Le fichier CSV contient probablement un format non standard ou des caractères spéciaux. \n            Veuillez vérifier que votre fichier est correctement formaté avec des séparateurs standards (virgules, points-virgules ou tabulations).\n            Conseil: Ouvrez le fichier dans un éditeur de texte pour vérifier sa structure.`);\n        } else {\n          setErrorMessage(`Erreur lors de l'importation: ${importError instanceof Error ? importError.message : 'Erreur inconnue'}`);\n        }\n      }\n    } catch (error) {\n      console.error('Erreur générale lors de l\\'importation:', error);\n      setErrorMessage(`Erreur lors de l'importation: ${error instanceof Error ? error.message : 'Erreur inconnue'}`);\n    } finally {\n      setImportLoading(false);\n    }\n  };\n  \n  return (\n    <Container maxWidth=\"lg\" sx={{ mt: 4, mb: 4 }}>\n      <Typography variant=\"h4\" component=\"h1\" gutterBottom>\n        Synchronisation SharePoint\n        <Tooltip title=\"Cette fonctionnalité permet d'exporter et d'importer des données entre Firebase et SharePoint via des fichiers intermédiaires.\">\n          <IconButton size=\"small\" sx={{ ml: 1 }}>\n            <HelpOutlineIcon />\n          </IconButton>\n        </Tooltip>\n      </Typography>\n      \n      <Alert severity=\"info\" sx={{ mb: 3 }}>\n        <Typography variant=\"body1\">\n          Cette interface permet de synchroniser manuellement les données entre Firebase et SharePoint.\n          En raison des limitations d'authentification, la synchronisation se fait via des fichiers intermédiaires.\n        </Typography>\n      </Alert>\n      \n      {successMessage && (\n        <Alert severity=\"success\" sx={{ mb: 2 }}>\n          {successMessage}\n        </Alert>\n      )}\n      \n      {errorMessage && (\n        <Alert severity=\"error\" sx={{ mb: 2 }}>\n          {errorMessage}\n        </Alert>\n      )}\n      \n      <Grid container spacing={3}>\n        {/* Section d'exportation */}\n        <Grid item xs={12} md={6}>\n          <Paper sx={{ p: 3, height: '100%' }}>\n            <Typography variant=\"h5\" component=\"h2\" gutterBottom>\n              Exporter des données\n              <Tooltip title=\"Exporter les données de Firebase vers un fichier que vous pourrez ensuite importer dans SharePoint.\">\n                <IconButton size=\"small\" sx={{ ml: 1 }}>\n                  <InfoIcon />\n                </IconButton>\n              </Tooltip>\n            </Typography>\n            \n            <Divider sx={{ my: 2 }} />\n            \n            <FormControl fullWidth margin=\"normal\">\n              <InputLabel>Collection à exporter</InputLabel>\n              <Select\n                value={exportCollection}\n                onChange={(e) => setExportCollection(e.target.value)}\n                label=\"Collection à exporter\"\n              >\n                <MenuItem value=\"\">Sélectionner une collection</MenuItem>\n                {collections.map((collection) => (\n                  <MenuItem key={collection} value={collection}>\n                    {collection}\n                  </MenuItem>\n                ))}\n                <MenuItem value=\"all\">Toutes les collections</MenuItem>\n              </Select>\n            </FormControl>\n            \n            <FormControl fullWidth margin=\"normal\">\n              <InputLabel>Format d'exportation</InputLabel>\n              <Select\n                value={exportFormat}\n                onChange={(e) => setExportFormat(e.target.value)}\n                label=\"Format d'exportation\"\n              >\n                <MenuItem value=\"json\">JSON</MenuItem>\n                <MenuItem value=\"csv\">CSV</MenuItem>\n                {exportCollection === 'all' && (\n                  <MenuItem value=\"zip\">ZIP (toutes les collections en JSON)</MenuItem>\n                )}\n              </Select>\n            </FormControl>\n            \n            <Button\n              variant=\"contained\"\n              color=\"primary\"\n              fullWidth\n              startIcon={exportLoading ? <CircularProgress size={24} color=\"inherit\" /> : <CloudDownloadIcon />}\n              onClick={handleExport}\n              disabled={exportLoading || !exportCollection}\n              sx={{ mt: 2 }}\n            >\n              {exportLoading ? 'Exportation en cours...' : 'Exporter'}\n            </Button>\n            \n            <Accordion sx={{ mt: 2 }}>\n              <AccordionSummary expandIcon={<ExpandMoreIcon />}>\n                <Typography>Instructions pour SharePoint</Typography>\n              </AccordionSummary>\n              <AccordionDetails>\n                <Typography variant=\"body2\">\n                  1. Exportez les données en utilisant le bouton ci-dessus.<br />\n                  2. Connectez-vous à votre site SharePoint.<br />\n                  3. Accédez à la bibliothèque de documents où vous souhaitez stocker les données.<br />\n                  4. Cliquez sur \"Charger\" et sélectionnez le fichier exporté.<br />\n                  5. Vérifiez que le fichier a été correctement chargé.\n                </Typography>\n              </AccordionDetails>\n            </Accordion>\n          </Paper>\n        </Grid>\n        \n        {/* Section d'importation */}\n        <Grid item xs={12} md={6}>\n          <Paper sx={{ p: 3, height: '100%' }}>\n            <Typography variant=\"h5\" component=\"h2\" gutterBottom>\n              Importer des données\n              <Tooltip title=\"Importer des données depuis un fichier SharePoint vers Firebase.\">\n                <IconButton size=\"small\" sx={{ ml: 1 }}>\n                  <InfoIcon />\n                </IconButton>\n              </Tooltip>\n            </Typography>\n            \n            <Divider sx={{ my: 2 }} />\n            \n            <FormControl fullWidth margin=\"normal\">\n              <InputLabel>Collection cible</InputLabel>\n              <Select\n                value={importCollection}\n                onChange={(e) => setImportCollection(e.target.value)}\n                label=\"Collection cible\"\n                disabled={importFile?.name.endsWith('.zip')}\n              >\n                <MenuItem value=\"\">Sélectionner une collection</MenuItem>\n                {collections.map((collection) => (\n                  <MenuItem key={collection} value={collection}>\n                    {collection}\n                  </MenuItem>\n                ))}\n              </Select>\n              {importFile?.name.endsWith('.zip') && (\n                <Typography variant=\"caption\" color=\"text.secondary\" sx={{ mt: 1 }}>\n                  Pour les fichiers ZIP, la collection est déterminée automatiquement.\n                </Typography>\n              )}\n            </FormControl>\n            \n            <Box sx={{ mt: 2 }}>\n              <Button\n                variant=\"outlined\"\n                component=\"label\"\n                fullWidth\n                startIcon={<CloudUploadIcon />}\n              >\n                Sélectionner un fichier\n                <input\n                  type=\"file\"\n                  hidden\n                  accept=\".json,.csv,.zip,.txt\"\n                  onChange={handleFileChange}\n                />\n              </Button>\n              {importFile && (\n                <Typography variant=\"body2\" sx={{ mt: 1 }}>\n                  Fichier sélectionné: {importFile.name}\n                </Typography>\n              )}\n              <Typography variant=\"caption\" color=\"text.secondary\" sx={{ display: 'block', mt: 1 }}>\n                Formats supportés: JSON, CSV, ZIP, et TXT (pour les sites)\n              </Typography>\n            </Box>\n            \n            <Box sx={{ mt: 2 }}>\n              <FormControlLabel\n                control={\n                  <Checkbox\n                    checked={importOptions.clearCollection}\n                    onChange={(e) => setImportOptions({ ...importOptions, clearCollection: e.target.checked })}\n                  />\n                }\n                label=\"Vider la collection avant l'importation\"\n              />\n              \n              <FormControlLabel\n                control={\n                  <Checkbox\n                    checked={importOptions.updateExisting}\n                    onChange={(e) => setImportOptions({ ...importOptions, updateExisting: e.target.checked })}\n                  />\n                }\n                label=\"Mettre à jour les documents existants\"\n              />\n            </Box>\n            \n            <Button\n              variant=\"contained\"\n              color=\"secondary\"\n              fullWidth\n              startIcon={importLoading ? <CircularProgress size={24} color=\"inherit\" /> : <CloudUploadIcon />}\n              onClick={handleImport}\n              disabled={importLoading || !importFile || (!importCollection && !importFile?.name.endsWith('.zip'))}\n              sx={{ mt: 2 }}\n            >\n              {importLoading ? 'Importation en cours...' : 'Importer'}\n            </Button>\n            \n            <Accordion sx={{ mt: 2 }}>\n              <AccordionSummary expandIcon={<ExpandMoreIcon />}>\n                <Typography>Instructions pour SharePoint</Typography>\n              </AccordionSummary>\n              <AccordionDetails>\n                <Typography variant=\"body2\">\n                  1. Connectez-vous à votre site SharePoint.<br />\n                  2. Accédez à la bibliothèque de documents où sont stockées les données.<br />\n                  3. Téléchargez le fichier que vous souhaitez importer.<br />\n                  4. Revenez à cette page et sélectionnez le fichier téléchargé.<br />\n                  5. Choisissez la collection cible et les options d'importation.<br />\n                  6. Cliquez sur \"Importer\" pour lancer l'importation.\n                </Typography>\n              </AccordionDetails>\n            </Accordion>\n            \n            <Accordion sx={{ mt: 2 }}>\n              <AccordionSummary expandIcon={<ExpandMoreIcon />}>\n                <Typography>Format CSV/TXT attendu</Typography>\n              </AccordionSummary>\n              <AccordionDetails>\n                <Typography variant=\"body2\" gutterBottom>\n                  <strong>Pour l'importation des sites</strong>, votre fichier CSV ou TXT doit contenir les colonnes suivantes (séparées par des virgules, des points-virgules ou des tabulations) :\n                </Typography>\n                <Typography variant=\"body2\" component=\"div\" sx={{ mt: 1, mb: 2 }}>\n                  <code style={{ display: 'block', whiteSpace: 'pre-wrap', backgroundColor: '#f5f5f5', padding: '8px', borderRadius: '4px', fontSize: '0.85rem' }}>\n                    PÔLE,NOM,TYPE,ADRESSE,VILLE,CODE POSTAL,TELEPHONE,EMAIL,CODE-BARRE,TOURNÉES,CODE PORTE,COORDONNÉES,STATUT\n                  </code>\n                </Typography>\n                <Typography variant=\"body2\" gutterBottom>\n                  <strong>Exemple de ligne valide :</strong>\n                </Typography>\n                <Typography variant=\"body2\" component=\"div\" sx={{ mt: 1, mb: 2 }}>\n                  <code style={{ display: 'block', whiteSpace: 'pre-wrap', backgroundColor: '#f5f5f5', padding: '8px', borderRadius: '4px', fontSize: '0.85rem' }}>\n                    Pôle Est,Laboratoire Central,Laboratoire,15 Rue des Sciences,Paris,75001,0123456789,lab@example.com,LAB001,\"tournee1,tournee2\",CODE123,,ACTIF\n                  </code>\n                </Typography>\n                <Typography variant=\"body2\" gutterBottom>\n                  <strong>Notes importantes :</strong>\n                </Typography>\n                <ul style={{ fontSize: '0.875rem', paddingLeft: '20px' }}>\n                  <li>Assurez-vous que chaque site est sur une ligne distincte</li>\n                  <li>Les tournées peuvent être séparées par des virgules à l'intérieur de guillemets</li>\n                  <li>Si votre fichier provient d'Excel, utilisez \"Enregistrer sous\" et choisissez le format CSV ou TXT</li>\n                  <li>Vérifiez que votre fichier utilise un séparateur standard (virgule, point-virgule ou tabulation)</li>\n                  <li>Si vous avez des problèmes, essayez d'ouvrir votre fichier dans un éditeur de texte pour vérifier sa structure</li>\n                </ul>\n                <Typography variant=\"body2\" sx={{ mt: 2 }} color=\"primary\">\n                  <strong>Recommandation pour les fichiers TXT :</strong> Pour une meilleure compatibilité, exportez depuis Excel en choisissant \"Texte (séparateur : tabulation) (*.txt)\". Les fichiers TXT utilisent par défaut la tabulation comme séparateur, ce qui évite les problèmes avec les virgules ou points-virgules dans les données.\n                </Typography>\n              </AccordionDetails>\n            </Accordion>\n            \n            <Accordion sx={{ mt: 2 }}>\n              <AccordionSummary expandIcon={<ExpandMoreIcon />}>\n                <Typography>Résolution des problèmes d'importation</Typography>\n              </AccordionSummary>\n              <AccordionDetails>\n                <Typography variant=\"body2\" gutterBottom>\n                  <strong>Erreur \"n.indexOf is not a function\"</strong>\n                </Typography>\n                <Typography variant=\"body2\" paragraph>\n                  Cette erreur se produit généralement lorsque le format du fichier CSV n'est pas standard. Voici comment la résoudre :\n                </Typography>\n                <ol style={{ fontSize: '0.875rem', paddingLeft: '20px' }}>\n                  <li>\n                    <strong>Vérifiez le format du fichier</strong> : Ouvrez votre fichier CSV ou TXT dans un éditeur de texte (comme Notepad) et vérifiez que :\n                    <ul style={{ marginTop: '4px' }}>\n                      <li>La première ligne contient bien les en-têtes des colonnes</li>\n                      <li>Les colonnes sont séparées par des virgules, des points-virgules ou des tabulations</li>\n                      <li>Il n'y a pas de caractères spéciaux ou de formatage particulier</li>\n                    </ul>\n                  </li>\n                  <li>\n                    <strong>Depuis Excel</strong> : Si vous exportez depuis Excel, suivez ces étapes :\n                    <ul style={{ marginTop: '4px' }}>\n                      <li>Sélectionnez \"Fichier\" &gt; \"Enregistrer sous\"</li>\n                      <li>Choisissez \"CSV (séparateur : point-virgule) (*.csv)\" ou \"Texte (séparateur : tabulation) (*.txt)\"</li>\n                      <li>Cliquez sur \"Enregistrer\"</li>\n                      <li>Ignorez les avertissements sur les fonctionnalités incompatibles</li>\n                    </ul>\n                  </li>\n                  <li>\n                    <strong>Créez un nouveau fichier</strong> : Si les solutions ci-dessus ne fonctionnent pas, créez un nouveau fichier CSV ou TXT :\n                    <ul style={{ marginTop: '4px' }}>\n                      <li>Ouvrez un éditeur de texte vide (comme Notepad)</li>\n                      <li>Copiez-collez les en-têtes sur la première ligne, séparés par des virgules ou des tabulations</li>\n                      <li>Ajoutez vos données sur les lignes suivantes, en respectant le même format</li>\n                      <li>Enregistrez le fichier avec l'extension .csv ou .txt</li>\n                    </ul>\n                  </li>\n                </ol>\n                <Typography variant=\"body2\" sx={{ mt: 2 }} paragraph>\n                  <strong>Exemple de fichier CSV/TXT valide</strong> (ouvert dans un éditeur de texte) :\n                </Typography>\n                <Typography variant=\"body2\" component=\"div\" sx={{ mt: 1, mb: 2 }}>\n                  <code style={{ display: 'block', whiteSpace: 'pre-wrap', backgroundColor: '#f5f5f5', padding: '8px', borderRadius: '4px', fontSize: '0.85rem' }}>\n                    PÔLE,NOM,TYPE,ADRESSE,VILLE,CODE POSTAL,TELEPHONE,EMAIL,CODE-BARRE,TOURNÉES,CODE PORTE,COORDONNÉES,STATUT<br/>\n                    Pôle Est,Laboratoire Central,Laboratoire,15 Rue des Sciences,Paris,75001,0123456789,lab@example.com,LAB001,\"tournee1,tournee2\",CODE123,,ACTIF<br/>\n                    Pôle Ouest,Entrepôt Principal,Entrepôt,25 Avenue du Commerce,Lyon,69002,0987654321,entrepot@example.com,ENT002,tournee3,CODE456,,ACTIF\n                  </code>\n                </Typography>\n                \n                <Typography variant=\"body2\" gutterBottom>\n                  <strong>Erreur \"Aucun document valide n'a pu être extrait du fichier\"</strong>\n                </Typography>\n                <Typography variant=\"body2\" paragraph>\n                  Cette erreur peut être causée par des problèmes d'encodage, particulièrement avec les caractères accentués. Voici comment la résoudre :\n                </Typography>\n                <ol style={{ fontSize: '0.875rem', paddingLeft: '20px' }}>\n                  <li>\n                    <strong>Vérifiez l'encodage du fichier</strong> : Assurez-vous que votre fichier est enregistré en UTF-8 :\n                    <ul style={{ marginTop: '4px' }}>\n                      <li>Dans Excel, utilisez \"Enregistrer sous\" et sélectionnez \"CSV UTF-8 (délimité par des virgules) (*.csv)\"</li>\n                      <li>Dans Notepad, utilisez \"Enregistrer sous\" et sélectionnez \"UTF-8\" dans le menu déroulant \"Encodage\"</li>\n                    </ul>\n                  </li>\n                  <li>\n                    <strong>Vérifiez les en-têtes</strong> : Assurez-vous que vos en-têtes correspondent aux noms attendus :\n                    <ul style={{ marginTop: '4px' }}>\n                      <li>Les en-têtes doivent contenir au moins \"NOM\" ou \"CODE-BARRE\" pour identifier chaque site</li>\n                      <li>Vérifiez que les accents sont correctement encodés (ex: \"PÔLE\" et non \"PLE\")</li>\n                    </ul>\n                  </li>\n                  <li>\n                    <strong>Utilisez un format TXT avec tabulations</strong> : Les fichiers TXT avec tabulations sont souvent plus fiables :\n                    <ul style={{ marginTop: '4px' }}>\n                      <li>Dans Excel, utilisez \"Enregistrer sous\" et sélectionnez \"Texte (séparateur : tabulation) (*.txt)\"</li>\n                      <li>Cela évite les problèmes avec les virgules ou points-virgules dans les données</li>\n                    </ul>\n                  </li>\n                </ol>\n              </AccordionDetails>\n            </Accordion>\n          </Paper>\n        </Grid>\n      </Grid>\n    </Container>\n  );\n};\n\nexport default SharePointSync; \r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}